<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="苍穹外卖学习笔记">
<title>苍穹外卖学习笔记</title>

<link rel='canonical' href='https://nova-bryan.github.io/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/'>

<link rel="stylesheet" href="/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css"><meta property='og:title' content="苍穹外卖学习笔记">
<meta property='og:description' content="苍穹外卖学习笔记">
<meta property='og:url' content='https://nova-bryan.github.io/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/'>
<meta property='og:site_name' content='Nova-Bryan'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Java后端' /><meta property='article:published_time' content='2024-04-13T18:46:11&#43;08:00'/><meta property='article:modified_time' content='2024-04-13T18:46:11&#43;08:00'/><meta property='og:image' content='https://nova-bryan.github.io/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image.png' />
<meta name="twitter:title" content="苍穹外卖学习笔记">
<meta name="twitter:description" content="苍穹外卖学习笔记"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://nova-bryan.github.io/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image.png' />
    <link rel="shortcut icon" href="/favicon.ico" />

  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "dark");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu18396025192540646182.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🤪</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Nova-Bryan</a></h1>
            <h2 class="site-description">记录学习与生活</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://blog.csdn.net/2301_80021118?spm=1000.2115.3001.5343'
                        target="_blank"
                        title="csdn"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><g fill="#03599C"><path d="M116.5 32.3c-.6-1.1-1.4-2.1-2.3-2.6l-48.1-27.8c-.8-.5-1.9-.7-3.1-.7-1.2 0-2.3.3-3.1.7l-48.5 27.8c-1.7 1-3.4 3.5-3.4 5.4v55.7c0 1.1.7 2.3 1.4 3.4l.1.1c.5.8 1.3 1.5 2 1.9l48.3 27.9c.8.5 2 .7 3.2.7 1.2 0 2.3-.3 3.1-.7l47.5-27.9c1.7-1 2.4-3.5 2.4-5.4v-55.7c0-.8.4-1.8 0-2.6l.5-.2zm-4.2 2.1c0 .3-.3.5-.3.7v55.7c0 .8-.2 1.7-.4 2l-47.6 27.8c-.1.1-.5.2-1.1.2-.6 0-1-.1-1.1-.2l-48.2-27.8s-.1-.1-.2-.1l-.6-.6c-.4-.7.2-1.1-.8-1.2v-55.7c1-.5.9-1.7 1.4-1.9l48.3-27.9c.1 0 .6-.2 1.2-.2s1 .1 1.1.2l48 27.7.4.9c.1.1-.1.3-.1.4zM63 38.5c9.1 0 17.1 5 21.3 12.5l13-7.5c-6.8-11.9-19.6-20-34.3-20-21.8 0-39.5 17.7-39.5 39.5s17.7 39.5 39.5 39.5c14.6 0 27.4-8 34.2-19.8l-12.9-7.6c-4.2 7.4-12.2 12.4-21.3 12.4-13.5 0-24.5-11-24.5-24.5s11-24.5 24.5-24.5z"/></g></svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/nova-bryan'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" ?><!DOCTYPE svg  PUBLIC '-//W3C//DTD SVG 1.1//EN'  'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'><svg enable-background="new 0 0 32 32" height="32px" version="1.1" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Github"><circle cx="16" cy="16" fill="#FFFFFF" r="14.5"/><path d="M30.5,16c0-1.339-0.196-2.631-0.536-3.862C27.83,6.787,22.612,3,16.5,3C8.492,3,2,9.492,2,17.5   c0,1.339,0.196,2.631,0.536,3.862C4.67,26.713,9.888,30.5,16,30.5C24.008,30.5,30.5,24.008,30.5,16z" fill="#80D8FF"/><g><path d="M20.95,29.614c-0.654,0.237-1.349-0.25-1.347-0.946c0.005-1.227,0.01-2.677,0.01-3.69    c0-1.358-0.464-2.246-0.984-2.696c3.23-0.36,6.62-1.591,6.62-7.183c0-1.59-0.561-2.889-1.491-3.907    c0.15-0.369,0.647-1.848-0.144-3.853c0,0-1.215-0.391-3.983,1.492c-1.158-0.323-2.399-0.484-3.63-0.49    c-1.233,0.006-2.473,0.167-3.63,0.49C9.601,6.949,8.383,7.34,8.383,7.34c-0.788,2.004-0.291,3.484-0.141,3.853    c-0.928,1.018-1.493,2.317-1.493,3.907c0,5.578,3.385,6.827,6.605,7.194c-0.415,0.364-0.79,1.006-0.921,1.946    c-0.827,0.373-2.926,1.016-4.221-1.209c0,0-0.766-1.397-2.22-1.5c0,0-1.417-0.018-0.1,0.885c0,0,0.951,0.448,1.609,2.129    c0,0,0.851,2.832,4.885,1.952c0.003,0.522,0.007,1.358,0.011,2.169c0.003,0.694-0.688,1.189-1.34,0.952    c-1.435-0.521-2.765-1.261-3.949-2.18C9.565,29.35,12.646,30.5,16,30.5c3.279,0,6.294-1.102,8.724-2.938    C23.584,28.421,22.316,29.118,20.95,29.614z" fill="#FFFFFF"/></g><path d="M11.393,30.176c-0.171,0-0.342-0.029-0.506-0.089C4.695,27.841,0.728,21.911,1.015,15.33   c0.012-0.275,0.232-0.485,0.521-0.478c0.276,0.012,0.49,0.246,0.478,0.521c-0.268,6.142,3.435,11.677,9.214,13.772   c0.151,0.056,0.318,0.033,0.453-0.063c0.139-0.098,0.218-0.25,0.217-0.417l-0.008-1.573c-3.927,0.561-4.857-2.375-4.867-2.406   c-0.552-1.405-1.342-1.82-1.35-1.824c-0.342-0.229-0.996-0.676-0.81-1.262c0.167-0.528,0.852-0.563,1.136-0.572   c1.736,0.122,2.616,1.693,2.652,1.76c0.956,1.643,2.414,1.446,3.335,1.094c0.09-0.452,0.239-0.863,0.439-1.216   c-2.872-0.486-6.176-1.973-6.176-7.568c0-1.531,0.479-2.88,1.424-4.016C7.465,10.408,7.205,8.97,7.917,7.157   C7.972,7.017,8.087,6.91,8.23,6.864C8.374,6.817,9.703,6.47,12.46,8.29c1.119-0.291,2.309-0.442,3.539-0.448   c1.234,0.006,2.423,0.157,3.543,0.448c2.756-1.82,4.08-1.473,4.226-1.426c0.143,0.046,0.257,0.153,0.312,0.292   c0.715,1.813,0.456,3.251,0.247,3.927c0.944,1.133,1.422,2.482,1.422,4.016c0,5.595-3.308,7.078-6.185,7.559   c0.354,0.623,0.549,1.426,0.549,2.32c0,1.013-0.005,2.465-0.01,3.692c0,0.166,0.077,0.315,0.214,0.412   c0.137,0.096,0.306,0.119,0.463,0.063C26.295,27.141,30,21.858,30,16c0-3.863-1.54-7.46-4.335-10.129   c-2.794-2.667-6.462-4.037-10.336-3.855c-0.275,0.021-0.509-0.201-0.523-0.476c-0.013-0.276,0.2-0.51,0.476-0.523   c4.152-0.19,8.08,1.274,11.073,4.131C29.351,8.007,31,11.861,31,16c0,6.277-3.97,11.937-9.878,14.084   c-0.463,0.167-0.978,0.099-1.38-0.185c-0.401-0.283-0.64-0.744-0.638-1.233c0.005-1.226,0.01-2.676,0.01-3.688   c0-1.459-0.567-2.107-0.811-2.317c-0.15-0.13-0.21-0.337-0.151-0.526c0.059-0.19,0.225-0.327,0.422-0.349   c3.054-0.34,6.176-1.401,6.176-6.686c0-1.38-0.458-2.582-1.36-3.569c-0.13-0.143-0.167-0.347-0.094-0.526   c0.139-0.34,0.524-1.537-0.042-3.198c-0.423,0.012-1.503,0.189-3.34,1.44c-0.122,0.083-0.274,0.109-0.416,0.068   c-1.084-0.302-2.293-0.465-3.499-0.472c-1.218,0.006-2.395,0.165-3.494,0.472c-0.141,0.042-0.293,0.015-0.416-0.068   c-1.83-1.245-2.91-1.427-3.346-1.438c-0.563,1.661-0.177,2.855-0.039,3.196c0.072,0.179,0.036,0.383-0.094,0.525   c-0.904,0.991-1.362,2.192-1.362,3.57c0,5.282,3.115,6.35,6.162,6.697c0.196,0.022,0.361,0.158,0.42,0.347   c0.059,0.188,0.001,0.395-0.147,0.525c-0.224,0.197-0.621,0.672-0.756,1.64c-0.023,0.17-0.133,0.316-0.29,0.386   c-0.75,0.338-3.316,1.237-4.858-1.413c-0.011-0.019-0.525-0.921-1.444-1.186c0.326,0.218,1.077,0.852,1.631,2.265   c0.043,0.133,0.808,2.409,4.313,1.646c0.148-0.031,0.301,0.003,0.419,0.098c0.118,0.094,0.187,0.237,0.188,0.387l0.011,2.17   c0.002,0.491-0.237,0.955-0.641,1.239C12,30.082,11.698,30.176,11.393,30.176z" fill="#455A64"/><path d="M15.737,31C7.474,31,1,24.411,1,16c0-3.629,1.238-7.111,3.485-9.804c0.176-0.212,0.493-0.241,0.704-0.063   C5.401,6.31,5.43,6.625,5.253,6.837C3.155,9.35,2,12.604,2,16c0,7.851,6.034,14,13.737,14C23.602,30,30,23.72,30,16   S23.602,2,15.737,2c-2.441,0-4.812,0.62-6.858,1.792C8.641,3.927,8.334,3.845,8.197,3.606C8.06,3.366,8.143,3.061,8.382,2.923   C10.579,1.665,13.123,1,15.737,1C24.153,1,31,7.729,31,16S24.153,31,15.737,31z" fill="#455A64"/><g><g><g><g><g><g><path d="M7.543,4.552c0,0.275-0.225,0.5-0.5,0.5l0,0c-0.275,0-0.5-0.225-0.5-0.5l0,0         c0-0.275,0.225-0.5,0.5-0.5l0,0C7.318,4.052,7.543,4.276,7.543,4.552L7.543,4.552z" fill="#455A64"/></g></g></g></g></g></g></g></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>友情链接</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#软件开发整体介绍">软件开发整体介绍</a>
      <ol>
        <li><a href="#软件开发流程">软件开发流程</a>
          <ol>
            <li><a href="#需求分析">需求分析</a></li>
            <li><a href="#设计">设计</a></li>
            <li><a href="#编码">编码</a></li>
            <li><a href="#测试">测试</a></li>
            <li><a href="#上线运维">上线运维</a></li>
          </ol>
        </li>
        <li><a href="#角色分工">角色分工</a></li>
        <li><a href="#软件环境">软件环境</a>
          <ol>
            <li><a href="#开发环境">开发环境</a></li>
            <li><a href="#测试环境">测试环境</a></li>
            <li><a href="#生产环境">生产环境</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#苍穹外卖项目介绍">苍穹外卖项目介绍</a>
      <ol>
        <li><a href="#项目介绍">项目介绍</a></li>
        <li><a href="#产品原型">产品原型</a></li>
        <li><a href="#技术选型">技术选型</a></li>
      </ol>
    </li>
    <li><a href="#开发环境搭建">开发环境搭建</a>
      <ol>
        <li><a href="#前端环境搭建">前端环境搭建</a>
          <ol>
            <li><a href="#整体结构">整体结构</a></li>
          </ol>
        </li>
        <li><a href="#后端环境搭建">后端环境搭建</a>
          <ol>
            <li><a href="#熟悉项目结构">熟悉项目结构</a></li>
            <li><a href="#使用git进行版本控制">使用Git进行版本控制</a></li>
            <li><a href="#数据库环境搭建">数据库环境搭建</a></li>
            <li><a href="#前后端联调">前后端联调</a></li>
            <li><a href="#nginx">Nginx🆕</a></li>
            <li><a href="#完善登录功能">完善登录功能</a></li>
          </ol>
        </li>
        <li><a href="#导入接口文档">导入接口文档</a>
          <ol>
            <li><a href="#前后端分离开发流程">前后端分离开发流程</a></li>
            <li><a href="#操作步骤">操作步骤</a></li>
          </ol>
        </li>
        <li><a href="#swagger">Swagger</a>
          <ol>
            <li><a href="#介绍">介绍</a></li>
            <li><a href="#使用方式">使用方式</a></li>
            <li><a href="#常用注解">常用注解</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#员工管理分类管理">员工管理、分类管理</a>
      <ol>
        <li><a href="#新增员工">新增员工</a>
          <ol>
            <li><a href="#需求分析和设计">需求分析和设计</a></li>
            <li><a href="#代码开发">代码开发</a></li>
            <li><a href="#功能测试">功能测试</a></li>
            <li><a href="#代码完善">代码完善</a></li>
          </ol>
        </li>
        <li><a href="#员工分页查询">员工分页查询</a>
          <ol>
            <li><a href="#需求分析和设计-1">需求分析和设计</a></li>
            <li><a href="#代码开发-1">代码开发</a></li>
            <li><a href="#功能测试-1">功能测试</a></li>
            <li><a href="#代码完善-1">代码完善</a></li>
          </ol>
        </li>
        <li><a href="#启用禁用员工账号">启用禁用员工账号</a>
          <ol>
            <li><a href="#需求分析和设计-2">需求分析和设计</a></li>
            <li><a href="#代码开发-2">代码开发</a></li>
            <li><a href="#功能测试-2">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#编辑员工">编辑员工</a>
          <ol>
            <li><a href="#需求分析和设计-3">需求分析和设计</a></li>
            <li><a href="#代码开发-3">代码开发</a></li>
            <li><a href="#功能测试-3">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#导入分类模块功能代码">导入分类模块功能代码</a>
          <ol>
            <li><a href="#需求分析和设计-4">需求分析和设计</a></li>
            <li><a href="#代码导入">代码导入</a></li>
            <li><a href="#功能测试-4">功能测试</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#菜品管理">菜品管理</a>
      <ol>
        <li><a href="#公共字段自动填充">公共字段自动填充🌟</a>
          <ol>
            <li><a href="#问题分析">问题分析</a></li>
            <li><a href="#实现思路">实现思路</a></li>
            <li><a href="#代码开发-4">代码开发</a></li>
            <li><a href="#功能测试-5">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#新增菜品">新增菜品</a>
          <ol>
            <li><a href="#需求分析和设计-5">需求分析和设计</a></li>
            <li><a href="#代码开发-5">代码开发</a></li>
            <li><a href="#功能测试-6">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#菜品分页查询">菜品分页查询</a>
          <ol>
            <li><a href="#需求分析和设计-6">需求分析和设计</a></li>
            <li><a href="#代码开发-6">代码开发</a></li>
            <li><a href="#功能测试-7">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#删除菜品">删除菜品</a>
          <ol>
            <li><a href="#需求分析和设计-7">需求分析和设计</a></li>
            <li><a href="#代码开发-7">代码开发</a></li>
            <li><a href="#功能测试-8">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#修改菜品">修改菜品</a>
          <ol>
            <li><a href="#需求分析和设计-8">需求分析和设计</a></li>
            <li><a href="#代码开发-8">代码开发</a></li>
            <li><a href="#功能测试-9">功能测试</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#店铺营业状态设置">店铺营业状态设置</a>
      <ol>
        <li><a href="#redis入门">Redis入门</a>
          <ol>
            <li><a href="#redis简介">Redis简介</a></li>
            <li><a href="#redis下载与安装">Redis下载与安装</a></li>
            <li><a href="#redis服务启动与停止">Redis服务启动与停止</a></li>
          </ol>
        </li>
        <li><a href="#redis数据类型">Redis数据类型</a>
          <ol>
            <li><a href="#5种常用数据类型介绍">5种常用数据类型介绍</a></li>
            <li><a href="#各种数据类型的特点">各种数据类型的特点</a></li>
          </ol>
        </li>
        <li><a href="#redis常用命令">Redis常用命令</a>
          <ol>
            <li><a href="#字符串操作命令">字符串操作命令</a></li>
            <li><a href="#哈希操作命令">哈希操作命令</a></li>
            <li><a href="#列表操作命令">列表操作命令</a></li>
            <li><a href="#集合操作命令">集合操作命令</a></li>
            <li><a href="#有序集合操作命令">有序集合操作命令</a></li>
            <li><a href="#通用命令">通用命令</a></li>
          </ol>
        </li>
        <li><a href="#在java中操作redis">在Java中操作Redis</a>
          <ol>
            <li><a href="#redis的java客户端">Redis的Java客户端</a></li>
            <li><a href="#spring-data-redis使用方式">Spring Data Redis使用方式</a></li>
          </ol>
        </li>
        <li><a href="#店铺营业状态">店铺营业状态</a>
          <ol>
            <li><a href="#需求分析和设计-9">需求分析和设计</a></li>
            <li><a href="#代码开发-9">代码开发</a></li>
            <li><a href="#功能测试-10">功能测试</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#微信登录商品浏览">微信登录、商品浏览</a>
      <ol>
        <li><a href="#httpclient">HttpClient🆕</a>
          <ol>
            <li><a href="#介绍-1">介绍</a></li>
            <li><a href="#入门案例">入门案例</a></li>
          </ol>
        </li>
        <li><a href="#微信小程序开发">微信小程序开发</a>
          <ol>
            <li><a href="#介绍-2">介绍</a></li>
            <li><a href="#准备工作">准备工作</a></li>
            <li><a href="#入门案例-1">入门案例</a></li>
          </ol>
        </li>
        <li><a href="#微信登录">微信登录</a>
          <ol>
            <li><a href="#导入小程序代码">导入小程序代码</a></li>
            <li><a href="#微信登录流程">微信登录流程</a></li>
            <li><a href="#需求分析和设计-10">需求分析和设计</a></li>
            <li><a href="#代码开发-10">代码开发</a></li>
            <li><a href="#功能测试-11">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#导入商品浏览功能代码">导入商品浏览功能代码</a>
          <ol>
            <li><a href="#需求分析和设计-11">需求分析和设计</a></li>
            <li><a href="#代码导入-1">代码导入</a></li>
            <li><a href="#功能测试-12">功能测试</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#缓存商品购物车">缓存商品、购物车</a>
      <ol>
        <li><a href="#缓存菜品">缓存菜品</a>
          <ol>
            <li><a href="#问题说明">问题说明</a></li>
            <li><a href="#实现思路-1">实现思路</a></li>
            <li><a href="#代码开发-11">代码开发</a></li>
            <li><a href="#功能测试-13">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#缓存套餐">缓存套餐</a>
          <ol>
            <li><a href="#spring-cache">Spring Cache⭐</a></li>
            <li><a href="#实现思路-2">实现思路</a></li>
            <li><a href="#代码开发-12">代码开发</a></li>
            <li><a href="#功能测试-14">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#添加购物车">添加购物车</a>
          <ol>
            <li><a href="#需求分析和设计-12">需求分析和设计</a></li>
            <li><a href="#代码开发-13">代码开发</a></li>
            <li><a href="#功能测试-15">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#查看购物车">查看购物车</a>
          <ol>
            <li><a href="#需求分析和设计-13">需求分析和设计</a></li>
            <li><a href="#代码开发-14">代码开发</a></li>
            <li><a href="#功能测试-16">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#清空购物车">清空购物车</a>
          <ol>
            <li><a href="#需求分析和设计-14">需求分析和设计</a></li>
            <li><a href="#功能测试-17">功能测试</a></li>
            <li><a href="#代码开发-15">代码开发</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#用户下单订单支付">用户下单、订单支付</a>
      <ol>
        <li><a href="#导入地址簿功能代码">导入地址簿功能代码</a>
          <ol>
            <li><a href="#需求分析和设计-15">需求分析和设计</a></li>
            <li><a href="#代码导入-2">代码导入</a></li>
            <li><a href="#功能测试-18">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#用户下单">用户下单</a>
          <ol>
            <li><a href="#需求分析和设计-16">需求分析和设计</a></li>
            <li><a href="#代码开发-16">代码开发</a></li>
            <li><a href="#功能测试-19">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#订单支付">订单支付</a>
          <ol>
            <li><a href="#微信支付介绍">微信支付介绍</a></li>
            <li><a href="#微信支付准备工作">微信支付准备工作</a></li>
            <li><a href="#代码导入-3">代码导入</a></li>
            <li><a href="#功能测试-20">功能测试</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#用户端历史订单模块">用户端历史订单模块</a>
      <ol>
        <li><a href="#1-查询历史订单">1. 查询历史订单</a>
          <ol>
            <li><a href="#11-需求分析和设计">1.1 需求分析和设计</a></li>
            <li><a href="#12-代码实现">1.2 代码实现</a></li>
            <li><a href="#13-功能测试">1.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#2-查询订单详情">2. 查询订单详情</a>
          <ol>
            <li><a href="#21-需求分析和设计">2.1 需求分析和设计</a></li>
            <li><a href="#22-代码实现">2.2 代码实现</a></li>
            <li><a href="#23-功能测试">2.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#3-取消订单">3. 取消订单</a>
          <ol>
            <li><a href="#31-需求分析和设计">3.1 需求分析和设计</a></li>
            <li><a href="#32-代码实现">3.2 代码实现</a></li>
            <li><a href="#33-功能测试">3.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#4-再来一单">4. 再来一单</a>
          <ol>
            <li><a href="#41-需求分析和设计">4.1 需求分析和设计</a></li>
            <li><a href="#42-代码实现">4.2 代码实现</a></li>
            <li><a href="#43-功能测试">4.3 功能测试</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#商家端订单管理模块">商家端订单管理模块</a>
      <ol>
        <li><a href="#1-订单搜索">1. 订单搜索</a>
          <ol>
            <li><a href="#11-需求分析和设计-1">1.1 需求分析和设计</a></li>
            <li><a href="#12-代码实现-1">1.2 代码实现</a></li>
            <li><a href="#13-功能测试-1">1.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#2-各个状态的订单数量统计">2. 各个状态的订单数量统计</a>
          <ol>
            <li><a href="#21-需求分析和设计-1">2.1 需求分析和设计</a></li>
            <li><a href="#22-代码实现-1">2.2 代码实现</a></li>
            <li><a href="#23-功能测试-1">2.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#3-查询订单详情">3. 查询订单详情</a>
          <ol>
            <li><a href="#31-需求分析和设计-1">3.1 需求分析和设计</a></li>
            <li><a href="#32-代码实现-1">3.2 代码实现</a></li>
            <li><a href="#33-功能测试-1">3.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#4-接单">4. 接单</a>
          <ol>
            <li><a href="#41-需求分析和设计-1">4.1 需求分析和设计</a></li>
            <li><a href="#42-代码实现-1">4.2 代码实现</a></li>
            <li><a href="#43-功能测试-1">4.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#5-拒单">5. 拒单</a>
          <ol>
            <li><a href="#51-需求分析和设计">5.1 需求分析和设计</a></li>
            <li><a href="#52-代码实现">5.2 代码实现</a></li>
            <li><a href="#53-功能测试">5.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#6-取消订单">6. 取消订单</a>
          <ol>
            <li><a href="#61-需求分析和设计">6.1 需求分析和设计</a></li>
            <li><a href="#62-代码实现">6.2 代码实现</a></li>
            <li><a href="#63-功能测试">6.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#7-派送订单">7. 派送订单</a>
          <ol>
            <li><a href="#71-需求分析和设计">7.1 需求分析和设计</a></li>
            <li><a href="#72-代码实现">7.2 代码实现</a></li>
            <li><a href="#73-功能测试">7.3 功能测试</a></li>
          </ol>
        </li>
        <li><a href="#8-完成订单">8. 完成订单</a>
          <ol>
            <li><a href="#81-需求分析和设计">8.1 需求分析和设计</a></li>
            <li><a href="#82-代码实现">8.2 代码实现</a></li>
            <li><a href="#83-功能测试">8.3 功能测试</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#校验收货地址是否超出配送范围">校验收货地址是否超出配送范围</a>
      <ol>
        <li><a href="#1-环境准备">1. 环境准备</a></li>
        <li><a href="#2-代码开发">2. 代码开发</a>
          <ol>
            <li><a href="#21-applicationyml">2.1 application.yml</a></li>
            <li><a href="#22-orderserviceimpl">2.2 OrderServiceImpl</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#订单状态定时处理来单提醒和客户催单">订单状态定时处理、来单提醒和客户催单</a>
      <ol>
        <li><a href="#spring-task">Spring Task</a>
          <ol>
            <li><a href="#介绍-3">介绍</a></li>
            <li><a href="#cron表达式">cron表达式</a></li>
            <li><a href="#入门案例-2">入门案例</a></li>
          </ol>
        </li>
        <li><a href="#订单状态定时处理">订单状态定时处理</a>
          <ol>
            <li><a href="#需求分析和设计-17">需求分析和设计</a></li>
            <li><a href="#代码开发-17">代码开发</a></li>
            <li><a href="#功能测试-21">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#websocket">WebSocket</a>
          <ol>
            <li><a href="#介绍-4">介绍</a></li>
            <li><a href="#入门案例-3">入门案例</a></li>
          </ol>
        </li>
        <li><a href="#来单提醒">来单提醒</a>
          <ol>
            <li><a href="#需求分析和设计-18">需求分析和设计</a></li>
            <li><a href="#代码开发-18">代码开发</a></li>
            <li><a href="#功能测试-22">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#客户催单">客户催单</a>
          <ol>
            <li><a href="#需求分析和设计-19">需求分析和设计</a></li>
            <li><a href="#代码开发-19">代码开发</a></li>
            <li><a href="#功能测试-23">功能测试</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#数据统计-图形报表">数据统计-图形报表</a>
      <ol>
        <li><a href="#apache-echarts">Apache Echarts</a>
          <ol>
            <li><a href="#介绍-5">介绍</a></li>
            <li><a href="#入门案例-4">入门案例</a></li>
          </ol>
        </li>
        <li><a href="#营业额统计">营业额统计</a>
          <ol>
            <li><a href="#需求分析和设计-20">需求分析和设计</a></li>
            <li><a href="#代码开发-20">代码开发</a></li>
            <li><a href="#功能测试-24">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#用户统计">用户统计</a>
          <ol>
            <li><a href="#需求分析和设计-21">需求分析和设计</a></li>
            <li><a href="#代码开发-21">代码开发</a></li>
            <li><a href="#功能测试-25">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#订单统计">订单统计</a>
          <ol>
            <li><a href="#需求分析和设计-22">需求分析和设计</a></li>
            <li><a href="#代码开发-22">代码开发</a></li>
            <li><a href="#功能测试-26">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#销量排行top10">销量排行Top10</a>
          <ol>
            <li><a href="#需求分析和设计-23">需求分析和设计</a></li>
            <li><a href="#代码开发-23">代码开发</a></li>
            <li><a href="#功能测试-27">功能测试</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#数据统计-excel报表">数据统计-Excel报表</a>
      <ol>
        <li><a href="#工作台">工作台</a>
          <ol>
            <li><a href="#需求分析和设计-24">需求分析和设计</a></li>
            <li><a href="#代码导入-4">代码导入</a></li>
            <li><a href="#功能测试-28">功能测试</a></li>
          </ol>
        </li>
        <li><a href="#apache-poi">Apache POI</a>
          <ol>
            <li><a href="#介绍-6">介绍</a></li>
            <li><a href="#入门案例-5">入门案例</a></li>
          </ol>
        </li>
        <li><a href="#导出运营数据excel报表">导出运营数据Excel报表</a>
          <ol>
            <li><a href="#需求分析和设计-25">需求分析和设计</a></li>
            <li><a href="#代码开发-24">代码开发</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                <img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image_hu547743554728521660.png"
                        srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image_hu547743554728521660.png 800w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image_hu9061791967262762568.png 1600w"
                        width="800" 
                        height="450" 
                        loading="lazy"
                        alt="Featured image of post 苍穹外卖学习笔记" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/java%E5%90%8E%E7%AB%AF/" >
                Java后端
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">苍穹外卖学习笔记</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            苍穹外卖学习笔记
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2024-04-13</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="苍穹外卖学习文档">苍穹外卖学习文档
</h1><h2 id="软件开发整体介绍">软件开发整体介绍
</h2><h3 id="软件开发流程">软件开发流程
</h3><h4 id="需求分析">需求分析
</h4><p>需求规格说明书、产品原型</p>
<h4 id="设计">设计
</h4><p>UI设计、数据库设计、接口设计</p>
<h4 id="编码">编码
</h4><p>项目代码、单元测试</p>
<h4 id="测试">测试
</h4><p>测试用例、测试报告</p>
<h4 id="上线运维">上线运维
</h4><p>软件环境安装、配置</p>
<h3 id="角色分工">角色分工
</h3><ul>
<li>
<p>项目经理</p>
<p>对整体项目负责，任务分配、把控进度</p>
</li>
<li>
<p>产品经理</p>
<p>进行需求调研。输出需求调研文档、产品原型等</p>
</li>
<li>
<p>UI设计师</p>
<p>根据产品模型输出界面效果图</p>
</li>
<li>
<p>架构师</p>
<p>项目整体架构设计、技术选型等</p>
</li>
<li>
<p>开发工程师</p>
<p>代码实现</p>
</li>
<li>
<p>测试工程师</p>
<p>编写测试用例，输出测试报告</p>
</li>
<li>
<p>运维工程师</p>
<p>软件环境搭建、项目上线</p>
</li>
</ul>
<h3 id="软件环境">软件环境
</h3><h4 id="开发环境">开发环境
</h4><p>开发人员在开发阶段使用的环境，一般外部用户无法访问</p>
<h4 id="测试环境">测试环境
</h4><p>专门给测试人员使用的环境，用于测试项目，一般外部用户无法访问</p>
<h4 id="生产环境">生产环境
</h4><p>即线上环境，正式提供对外服务的环境</p>
<h2 id="苍穹外卖项目介绍">苍穹外卖项目介绍
</h2><h3 id="项目介绍">项目介绍
</h3><p>定位：专门为餐饮企业定制的一款软件产品</p>
<p>功能架构：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657494.png"
	width="1385"
	height="822"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657494_hu2729162834663960442.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657494_hu12974994361270711513.png 1024w"
	loading="lazy"
	
		alt="image-20240729110900376"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="404px"
	
></p>
<h3 id="产品原型">产品原型
</h3><p>用于展示项目的业务功能</p>
<h3 id="技术选型">技术选型
</h3><p>展示项目中使用到的技术框架和中间件等</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657045.png"
	width="2288"
	height="837"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657045_hu12043458385882669370.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657045_hu1157667775056968356.png 1024w"
	loading="lazy"
	
		alt="image-20240729112434033"
	
	
		class="gallery-image" 
		data-flex-grow="273"
		data-flex-basis="656px"
	
></p>
<h2 id="开发环境搭建">开发环境搭建
</h2><h3 id="前端环境搭建">前端环境搭建
</h3><h4 id="整体结构">整体结构
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657055.png"
	width="1578"
	height="657"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657055_hu15371934081683024187.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657055_hu16421344787271245086.png 1024w"
	loading="lazy"
	
		alt="image-20240729112806737"
	
	
		class="gallery-image" 
		data-flex-grow="240"
		data-flex-basis="576px"
	
></p>
<p>通过Nginx代理</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657219.png"
	width="718"
	height="338"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657219_hu18360356644236962173.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657219_hu2681740542850799423.png 1024w"
	loading="lazy"
	
		alt="image-20240729113442408"
	
	
		class="gallery-image" 
		data-flex-grow="212"
		data-flex-basis="509px"
	
></p>
<h3 id="后端环境搭建">后端环境搭建
</h3><h4 id="熟悉项目结构">熟悉项目结构
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657372.png"
	width="1935"
	height="1010"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657372_hu10990826115575593287.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657372_hu15286997495876787136.png 1024w"
	loading="lazy"
	
		alt="image-20240729113352626"
	
	
		class="gallery-image" 
		data-flex-grow="191"
		data-flex-basis="459px"
	
></p>
<h5 id="sky-common子模块">sky-common子模块
</h5><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657365.png"
	width="243"
	height="379"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657365_hu7935571257016584699.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657365_hu4673458894541931301.png 1024w"
	loading="lazy"
	
		alt="image-20240729113639122"
	
	
		class="gallery-image" 
		data-flex-grow="64"
		data-flex-basis="153px"
	
></p>
<ol>
<li>constant：常量类</li>
<li>context：项目上下文相关</li>
<li>enumeration：枚举类</li>
<li>exception：自定义异常类</li>
<li>json：处理json转换</li>
<li>properties：springboot配置属性类，把配置文件中的配置项封装成对象</li>
<li>result：后端返回的结果</li>
<li>utils：工具类</li>
</ol>
<h5 id="sky-pojo子模块">sky-pojo子模块
</h5><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657408.png"
	width="221"
	height="262"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657408_hu6294461037031522667.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657408_hu4358675824506776342.png 1024w"
	loading="lazy"
	
		alt="image-20240729144242952"
	
	
		class="gallery-image" 
		data-flex-grow="84"
		data-flex-basis="202px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657043.png"
	width="1291"
	height="394"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657043_hu12705185550237141895.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657043_hu14275770192264949168.png 1024w"
	loading="lazy"
	
		alt="image-20240729144255067"
	
	
		class="gallery-image" 
		data-flex-grow="327"
		data-flex-basis="786px"
	
></p>
<h5 id="sky-server子模块">sky-server子模块
</h5><p>存放的是 配置文件、配置类、拦截器、controller、service、mapper、启动类等</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657636.png"
	width="271"
	height="358"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657636_hu7725414995309301047.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657636_hu5762665029474946198.png 1024w"
	loading="lazy"
	
		alt="image-20240729144646481"
	
	
		class="gallery-image" 
		data-flex-grow="75"
		data-flex-basis="181px"
	
></p>
<h4 id="使用git进行版本控制">使用Git进行版本控制
</h4><ul>
<li>创建Git本地仓库</li>
<li>创建Git远程仓库</li>
<li>将本地文件推送到Git远程仓库</li>
</ul>
<h4 id="数据库环境搭建">数据库环境搭建
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657837.png"
	width="1103"
	height="371"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657837_hu589224384242987343.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657837_hu15727854205048720515.png 1024w"
	loading="lazy"
	
		alt="image-20240729150543025"
	
	
		class="gallery-image" 
		data-flex-grow="297"
		data-flex-basis="713px"
	
></p>
<h4 id="前后端联调">前后端联调
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657263.png"
	width="2385"
	height="559"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657263_hu2271526800721044958.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657263_hu9221228804259537403.png 1024w"
	loading="lazy"
	
		alt="image-20240729151226183"
	
	
		class="gallery-image" 
		data-flex-grow="426"
		data-flex-basis="1023px"
	
></p>
<h4 id="nginx">Nginx🆕
</h4><p>反向代理，就是让前端发送的动态请求由Nginx转发到后端服务器</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657978.png"
	width="2256"
	height="191"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657978_hu5036676388062316701.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657978_hu11295014549777885872.png 1024w"
	loading="lazy"
	
		alt="image-20240729154056277"
	
	
		class="gallery-image" 
		data-flex-grow="1181"
		data-flex-basis="2834px"
	
></p>
<p>Nginx反向代理的好处</p>
<ul>
<li>
<p>提高访问速度</p>
</li>
<li>
<p>进行负载均衡</p>
<p>就是把大量的请求按照我们指定的方式均衡的分配给集群中的每台服务器</p>
</li>
<li>
<p>保证后端服务安全</p>
</li>
</ul>
<h6 id="nginx反向代理的配置方式">Nginx反向代理的配置方式
</h6><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657459.png"
	width="1914"
	height="596"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657459_hu13566812135272009659.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657459_hu6374795695436964356.png 1024w"
	loading="lazy"
	
		alt="image-20240729154703167"
	
	
		class="gallery-image" 
		data-flex-grow="321"
		data-flex-basis="770px"
	
><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657438.png"
	width="2256"
	height="270"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657438_hu17795584574687811140.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657438_hu16360807505483984166.png 1024w"
	loading="lazy"
	
		alt="image-20240729154857411"
	
	
		class="gallery-image" 
		data-flex-grow="835"
		data-flex-basis="2005px"
	
></p>
<h6 id="nginx负载均衡的配置方式">Nginx负载均衡的配置方式
</h6><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657135.png"
	width="1901"
	height="868"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657135_hu284028626901646043.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657135_hu8657020972248016752.png 1024w"
	loading="lazy"
	
		alt="image-20240729154950918"
	
	
		class="gallery-image" 
		data-flex-grow="219"
		data-flex-basis="525px"
	
></p>
<h6 id="nginx负载均衡策略">Nginx负载均衡策略
</h6><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657644.png"
	width="1697"
	height="610"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657644_hu6852038186766568478.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291657644_hu5327874646158182633.png 1024w"
	loading="lazy"
	
		alt="image-20240729155222125"
	
	
		class="gallery-image" 
		data-flex-grow="278"
		data-flex-basis="667px"
	
></p>
<p>轮询：平均接收到请求</p>
<h4 id="完善登录功能">完善登录功能
</h4><ol>
<li>修改数据库中的明文密码，改为MD5加密后的密文</li>
<li>修改Java代码，前端提交的密码进行MD5加密后再跟数据库中密码比对</li>
</ol>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291705630.png"
	width="1716"
	height="327"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291705630_hu17542905132061214308.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291705630_hu8929712458742375544.png 1024w"
	loading="lazy"
	
		alt="image-20240729170539456"
	
	
		class="gallery-image" 
		data-flex-grow="524"
		data-flex-basis="1259px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291707979.png"
	width="675"
	height="116"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291707979_hu15312503901603485425.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291707979_hu14851726847555551307.png 1024w"
	loading="lazy"
	
		alt="image-20240729170715948"
	
	
		class="gallery-image" 
		data-flex-grow="581"
		data-flex-basis="1396px"
	
></p>
<h3 id="导入接口文档">导入接口文档
</h3><h4 id="前后端分离开发流程">前后端分离开发流程
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291719030.png"
	width="1482"
	height="707"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291719030_hu1421465638453178040.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291719030_hu3297065408177137427.png 1024w"
	loading="lazy"
	
		alt="image-20240729171913958"
	
	
		class="gallery-image" 
		data-flex-grow="209"
		data-flex-basis="503px"
	
></p>
<h4 id="操作步骤">操作步骤
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291721239.png"
	width="789"
	height="271"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291721239_hu12550547298799718902.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291721239_hu10307789000012851228.png 1024w"
	loading="lazy"
	
		alt="image-20240729172149205"
	
	
		class="gallery-image" 
		data-flex-grow="291"
		data-flex-basis="698px"
	
></p>
<p>这里YApi可换成ApiPost，导入数据选择YApi即可</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291732761.png"
	width="1258"
	height="824"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291732761_hu6522719127104584517.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291732761_hu7492102494455229310.png 1024w"
	loading="lazy"
	
		alt="image-20240729173254713"
	
	
		class="gallery-image" 
		data-flex-grow="152"
		data-flex-basis="366px"
	
></p>
<h3 id="swagger">Swagger
</h3><h4 id="介绍">介绍
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291734278.png"
	width="2258"
	height="825"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291734278_hu7964783254151147918.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291734278_hu16861713203328989358.png 1024w"
	loading="lazy"
	
		alt="image-20240729173436192"
	
	
		class="gallery-image" 
		data-flex-grow="273"
		data-flex-basis="656px"
	
></p>
<h4 id="使用方式">使用方式
</h4><ol>
<li>
<p>导入knife4j的maven坐标</p>
</li>
<li>
<p>在配置类中加入knife4j相关配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 通过knife4j生成接口文档
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Docket</span><span class="w"> </span><span class="nf">docket</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ApiInfo</span><span class="w"> </span><span class="n">apiInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ApiInfoBuilder</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">title</span><span class="p">(</span><span class="s">&#34;苍穹外卖项目接口文档&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">version</span><span class="p">(</span><span class="s">&#34;2.0&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="s">&#34;苍穹外卖项目接口文档&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Docket</span><span class="w"> </span><span class="n">docket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Docket</span><span class="p">(</span><span class="n">DocumentationType</span><span class="p">.</span><span class="na">SWAGGER_2</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">apiInfo</span><span class="p">(</span><span class="n">apiInfo</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">select</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            	</span><span class="c1">//指定生成接口需要扫描的包</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">apis</span><span class="p">(</span><span class="n">RequestHandlerSelectors</span><span class="p">.</span><span class="na">basePackage</span><span class="p">(</span><span class="s">&#34;com.sky.controller&#34;</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">paths</span><span class="p">(</span><span class="n">PathSelectors</span><span class="p">.</span><span class="na">any</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">docket</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>设置静态资源映射，否则接口文档页面无法访问</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 设置静态资源映射
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param registry
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addResourceHandlers</span><span class="p">(</span><span class="n">ResourceHandlerRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;开始设置静态资源映射...&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">addResourceHandler</span><span class="p">(</span><span class="s">&#34;/doc.html&#34;</span><span class="p">).</span><span class="na">addResourceLocations</span><span class="p">(</span><span class="s">&#34;classpath:/META-INF/resources/&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">addResourceHandler</span><span class="p">(</span><span class="s">&#34;/webjars/**&#34;</span><span class="p">).</span><span class="na">addResourceLocations</span><span class="p">(</span><span class="s">&#34;classpath:/META-INF/resources/webjars/&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h4 id="常用注解">常用注解
</h4><p>通过注解可以控制生成的接口文档，使接口文档拥有更好的可读性，常用注解如下：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291907399.png"
	width="1936"
	height="423"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291907399_hu15277502481450583647.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407291907399_hu10674681268460348068.png 1024w"
	loading="lazy"
	
		alt="image-20240729190727324"
	
	
		class="gallery-image" 
		data-flex-grow="457"
		data-flex-basis="1098px"
	
></p>
<h2 id="员工管理分类管理">员工管理、分类管理
</h2><p>员工管理界面</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300938129.png"
	width="2159"
	height="1029"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300938129_hu17951596683079308187.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300938129_hu6243631780339748279.png 1024w"
	loading="lazy"
	
		alt="image-20240730093858032"
	
	
		class="gallery-image" 
		data-flex-grow="209"
		data-flex-basis="503px"
	
></p>
<p>分类管理界面</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300939668.png"
	width="2166"
	height="1036"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300939668_hu17204818706010787256.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300939668_hu17470402886413524489.png 1024w"
	loading="lazy"
	
		alt="image-20240730093917566"
	
	
		class="gallery-image" 
		data-flex-grow="209"
		data-flex-basis="501px"
	
></p>
<h3 id="新增员工">新增员工
</h3><h4 id="需求分析和设计">需求分析和设计
</h4><h5 id="产品原型-1">产品原型
</h5><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300943277.png"
	width="1152"
	height="623"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300943277_hu208725973074174058.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300943277_hu17499894634098274140.png 1024w"
	loading="lazy"
	
		alt="image-20240730094312236"
	
	
		class="gallery-image" 
		data-flex-grow="184"
		data-flex-basis="443px"
	
></p>
<h5 id="接口设计">接口设计
</h5><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300947898.png"
	width="476"
	height="697"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300947898_hu15834871555388127589.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300947898_hu10193206953197291286.png 1024w"
	loading="lazy"
	
		alt="image-20240730094713856"
	
	
		class="gallery-image" 
		data-flex-grow="68"
		data-flex-basis="163px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300947957.png"
	width="434"
	height="214"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300947957_hu5701470591886372841.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407300947957_hu4859834437662834428.png 1024w"
	loading="lazy"
	
		alt="image-20240730094757928"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="486px"
	
></p>
<p>本项目约定：</p>
<ul>
<li><strong>管理端</strong>发出的请求，统一使用<code>/admin</code>作为前缀</li>
<li><strong>用户端</strong>发出的请求，统一使用<code>/user</code>作为前缀</li>
</ul>
<h5 id="数据库设计">数据库设计
</h5><p>employee表为员工表，用于存储商家内部的员工信息。具体表结构如下：</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">字段名</th>
<th>数据类型</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">id</td>
<td>bigint</td>
<td>主键</td>
<td>自增⭐</td>
</tr>
<tr>
<td style="text-align:left">name</td>
<td>varchar(32)</td>
<td>姓名</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">username</td>
<td>varchar(32)</td>
<td>用户名</td>
<td>唯一⭐</td>
</tr>
<tr>
<td style="text-align:left">password</td>
<td>varchar(64)</td>
<td>密码</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">phone</td>
<td>varchar(11)</td>
<td>手机号</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">sex</td>
<td>varchar(2)</td>
<td>性别</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">id_number</td>
<td>varchar(18)</td>
<td>身份证号</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">status</td>
<td>int</td>
<td>账号状态</td>
<td>1正常 0锁定⭐</td>
</tr>
<tr>
<td style="text-align:left">create_time</td>
<td>datetime</td>
<td>创建时间</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">update_time</td>
<td>datetime</td>
<td>最后修改时间</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">create_user</td>
<td>bigint</td>
<td>创建人id</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">update_user</td>
<td>bigint</td>
<td>最后修改人id</td>
<td></td>
</tr>
</tbody>
</table></div>
<h4 id="代码开发">代码开发
</h4><p>根据新增员工接口设计对应的DTO</p>
<p>注意：当前端提交的数据和实体类中对应的属性差别比较大时，建议使用DTO来封装数据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">	</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 新增员工
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param employeeDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="n">EmployeeDTO</span><span class="w"> </span><span class="n">employeeDTO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Employee</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Employee</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//对象属性拷贝，属性名必须一致</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">BeanUtils</span><span class="p">.</span><span class="na">copyProperties</span><span class="p">(</span><span class="n">employeeDTO</span><span class="p">,</span><span class="w"> </span><span class="n">employee</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//设置账号的状态，默认正常状态，1表示正常，0表示锁定</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employee</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">StatusConstant</span><span class="p">.</span><span class="na">ENABLE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//设置密码，默认密码为123456</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employee</span><span class="p">.</span><span class="na">setPassword</span><span class="p">(</span><span class="n">DigestUtils</span><span class="p">.</span><span class="na">md5DigestAsHex</span><span class="p">(</span><span class="n">PasswordConstant</span><span class="p">.</span><span class="na">DEFAULT_PASSWORD</span><span class="p">.</span><span class="na">getBytes</span><span class="p">()));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//设置当前记录的创建时间和修改时间</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employee</span><span class="p">.</span><span class="na">setCreateTime</span><span class="p">(</span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employee</span><span class="p">.</span><span class="na">setUpdateTime</span><span class="p">(</span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//设置当前记录的创建人id和修改人id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// TODO 后期需要改为当前登录的用户id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employee</span><span class="p">.</span><span class="na">setCreateUser</span><span class="p">(</span><span class="n">10L</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employee</span><span class="p">.</span><span class="na">setUpdateUser</span><span class="p">(</span><span class="n">10L</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employeeMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">employee</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="功能测试">功能测试
</h4><ul>
<li>通过Swagger接口文档测试</li>
<li>通过前后端联调测试</li>
</ul>
<p>注意：由于开发阶段前端和后端是并行开发的，后端完成某个功能后，此时前端对应的功能可能还没有开发完成，导致无法进行前后端联调测试。所以在开发阶段，后端测试主要以接口文档测试为主。</p>
<h4 id="代码完善">代码完善
</h4><p>程序存在的问题：</p>
<ul>
<li>录入的用户名已存在，抛出异常后没有处理</li>
<li>新增员工时，创建人id和修改人id设置为了固定值</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301105894.png"
	width="1250"
	height="1028"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301105894_hu10788297934029868838.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301105894_hu1493580113800902777.png 1024w"
	loading="lazy"
	
		alt="image-20240730110517800"
	
	
		class="gallery-image" 
		data-flex-grow="121"
		data-flex-basis="291px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301107001.png"
	width="2089"
	height="496"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301107001_hu7189776035335160336.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301107001_hu14537041544145829082.png 1024w"
	loading="lazy"
	
		alt="image-20240730110748941"
	
	
		class="gallery-image" 
		data-flex-grow="421"
		data-flex-basis="1010px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301107653.png"
	width="2139"
	height="627"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301107653_hu2722832500828512668.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301107653_hu410738117581206326.png 1024w"
	loading="lazy"
	
		alt="image-20240730110758581"
	
	
		class="gallery-image" 
		data-flex-grow="341"
		data-flex-basis="818px"
	
></p>
<p><strong>解析出登录员工id后，如何传递给Service的save方法？</strong></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301116432.png"
	width="2287"
	height="606"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301116432_hu865344636875062182.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301116432_hu9751959679140792235.png 1024w"
	loading="lazy"
	
		alt="image-20240730111602354"
	
	
		class="gallery-image" 
		data-flex-grow="377"
		data-flex-basis="905px"
	
></p>
<h3 id="员工分页查询">员工分页查询
</h3><h4 id="需求分析和设计-1">需求分析和设计
</h4><p>产品原型</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301125967.png"
	width="1096"
	height="723"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301125967_hu17462576855183775621.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301125967_hu7885290879765037717.png 1024w"
	loading="lazy"
	
		alt="image-20240730112519920"
	
	
		class="gallery-image" 
		data-flex-grow="151"
		data-flex-basis="363px"
	
></p>
<p>业务规则：</p>
<ul>
<li>根据每页展示员工信息</li>
<li>每页展示10条数据</li>
<li>分页查询时可以根据需要，输入员工姓名进行查询</li>
</ul>
<p>接口设计</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301658600.png"
	width="302"
	height="471"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301658600_hu12833737385069777205.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301658600_hu13406523737888495300.png 1024w"
	loading="lazy"
	
		alt="image-20240730165845560"
	
	
		class="gallery-image" 
		data-flex-grow="64"
		data-flex-basis="153px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301658091.png"
	width="584"
	height="668"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301658091_hu555396323271421548.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301658091_hu5972452384636586663.png 1024w"
	loading="lazy"
	
		alt="image-20240730165859053"
	
	
		class="gallery-image" 
		data-flex-grow="87"
		data-flex-basis="209px"
	
></p>
<h4 id="代码开发-1">代码开发
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301700459.png"
	width="2158"
	height="927"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301700459_hu10816379877845038670.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301700459_hu18373866533216037264.png 1024w"
	loading="lazy"
	
		alt="image-20240730170022373"
	
	
		class="gallery-image" 
		data-flex-grow="232"
		data-flex-basis="558px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301701122.png"
	width="2070"
	height="751"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301701122_hu7545856219838600693.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407301701122_hu14834577106972788246.png 1024w"
	loading="lazy"
	
		alt="image-20240730170135049"
	
	
		class="gallery-image" 
		data-flex-grow="275"
		data-flex-basis="661px"
	
></p>
<p>员工信息分页查询后端返回的对象类型为：<code>Result&lt;PageResult&gt;</code></p>
<p>mybatis提供的分页查询框架<code>pagehelper</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">com</span><span class="p">.</span><span class="na">github</span><span class="p">.</span><span class="na">pagehelper</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">pagehelper</span><span class="o">-</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">starter</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">$</span><span class="p">{</span><span class="n">pagehelper</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="功能测试-1">功能测试
</h4><p>可以通过接口文档进行测试，也可以进行前后端联调测试。</p>
<h4 id="代码完善-1">代码完善
</h4><p>最后操作时间需要修改成年月日</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407302320313.png"
	width="156"
	height="273"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407302320313_hu13246303935535861919.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407302320313_hu4430628361769032574.png 1024w"
	loading="lazy"
	
		alt="image-20240730232027270"
	
	
		class="gallery-image" 
		data-flex-grow="57"
		data-flex-basis="137px"
	
></p>
<p>解决方式：</p>
<ul>
<li>
<p>方式一：在属性上加入注解，对日期进行格式化</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@JsonFormat</span><span class="p">(</span><span class="n">pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;yyyy-MM-dd HH:mm:ss&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updateTime</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>方式二：在Webconfiguration中扩展SpringMvc的消息转换器，统一对日期类型进行格式化处理</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407302323858.png"
	width="1675"
	height="607"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407302323858_hu649776173496527647.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407302323858_hu13632403180415191529.png 1024w"
	loading="lazy"
	
		alt="image-20240730232329779"
	
	
		class="gallery-image" 
		data-flex-grow="275"
		data-flex-basis="662px"
	
></p>
</li>
</ul>
<h3 id="启用禁用员工账号">启用禁用员工账号
</h3><h4 id="需求分析和设计-2">需求分析和设计
</h4><p>产品原型</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311045969.png"
	width="1117"
	height="526"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311045969_hu5007245613651274099.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311045969_hu4974105885857360393.png 1024w"
	loading="lazy"
	
		alt="image-20240731104555917"
	
	
		class="gallery-image" 
		data-flex-grow="212"
		data-flex-basis="509px"
	
></p>
<p>业务规则：</p>
<ul>
<li>可以对状态为“启用”的员工账号进行“禁用”操作</li>
<li>可以对状态为“禁用”的员工账号进行“启用”操作</li>
<li>状态为“禁用”的员工账号不能登录系统</li>
</ul>
<p>接口设计</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311048643.png"
	width="402"
	height="580"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311048643_hu11545857203259540008.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311048643_hu8246869209626959700.png 1024w"
	loading="lazy"
	
		alt="image-20240731104815608"
	
	
		class="gallery-image" 
		data-flex-grow="69"
		data-flex-basis="166px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311048145.png"
	width="421"
	height="224"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311048145_hu13205599975276550401.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311048145_hu2746971342604962099.png 1024w"
	loading="lazy"
	
		alt="image-20240731104830116"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="451px"
	
></p>
<h4 id="代码开发-2">代码开发
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">		</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 启用/禁用员工账号
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param status
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PostMapping</span><span class="p">(</span><span class="s">&#34;status/{status}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;启用/禁用员工账号&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="nf">startOrStop</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&#34;status&#34;</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;启用/禁用员工账号：{}, {}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employeeService</span><span class="p">.</span><span class="na">startOrStop</span><span class="p">(</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 启用/禁用员工账号
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param status
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">startOrStop</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// update employee set status = ? where id = ?</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="cm">/*Employee employee = new Employee();
</span></span></span><span class="line"><span class="cl"><span class="cm">        employee.setStatus(status);
</span></span></span><span class="line"><span class="cl"><span class="cm">        employee.setId(id);*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Employee</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Employee</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">id</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employeeMapper</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">employee</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">&lt;</span><span class="n">update</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="s">&#34;update&#34;</span><span class="w"> </span><span class="n">parameterType</span><span class="o">=</span><span class="s">&#34;Employee&#34;</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">update</span><span class="w"> </span><span class="n">employee</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">&lt;</span><span class="n">set</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="k">if</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="s">&#34;name != null&#34;</span><span class="o">&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">name</span><span class="p">},</span><span class="o">&lt;/</span><span class="k">if</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="k">if</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="s">&#34;username != null&#34;</span><span class="o">&gt;</span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">username</span><span class="p">},</span><span class="o">&lt;/</span><span class="k">if</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="k">if</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="s">&#34;password != null&#34;</span><span class="o">&gt;</span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">password</span><span class="p">},</span><span class="o">&lt;/</span><span class="k">if</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="k">if</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="s">&#34;phone != null&#34;</span><span class="o">&gt;</span><span class="n">phone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">phone</span><span class="p">},</span><span class="o">&lt;/</span><span class="k">if</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="k">if</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="s">&#34;sex != null&#34;</span><span class="o">&gt;</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">sex</span><span class="p">},</span><span class="o">&lt;/</span><span class="k">if</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="k">if</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="s">&#34;idNumber != null&#34;</span><span class="o">&gt;</span><span class="n">id_Number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">idNumber</span><span class="p">},</span><span class="o">&lt;/</span><span class="k">if</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="k">if</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="s">&#34;updateTime != null&#34;</span><span class="o">&gt;</span><span class="n">update_Time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">updateTime</span><span class="p">},</span><span class="o">&lt;/</span><span class="k">if</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="k">if</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="s">&#34;updateUser != null&#34;</span><span class="o">&gt;</span><span class="n">update_User</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">updateUser</span><span class="p">},</span><span class="o">&lt;/</span><span class="k">if</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="k">if</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="s">&#34;status != null&#34;</span><span class="o">&gt;</span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">status</span><span class="p">},</span><span class="o">&lt;/</span><span class="k">if</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">&lt;/</span><span class="n">set</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">where</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">#</span><span class="p">{</span><span class="n">id</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">&lt;/</span><span class="n">update</span><span class="o">&gt;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="功能测试-2">功能测试
</h4><h3 id="编辑员工">编辑员工
</h3><h4 id="需求分析和设计-3">需求分析和设计
</h4><p>产品原型</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311113249.png"
	width="1091"
	height="556"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311113249_hu4614038294491688228.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311113249_hu4961595241043319731.png 1024w"
	loading="lazy"
	
		alt="image-20240731111326199"
	
	
		class="gallery-image" 
		data-flex-grow="196"
		data-flex-basis="470px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311113541.png"
	width="659"
	height="403"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311113541_hu9536110157077255763.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311113541_hu9661947019295200889.png 1024w"
	loading="lazy"
	
		alt="image-20240731111347506"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="392px"
	
></p>
<p>编辑员工功能涉及到两个接口：</p>
<ul>
<li>根据id查询员工信息</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311116859.png"
	width="221"
	height="351"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311116859_hu2992123231143846513.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311116859_hu941276817634219847.png 1024w"
	loading="lazy"
	
		alt="image-20240731111621824"
	
	
		class="gallery-image" 
		data-flex-grow="62"
		data-flex-basis="151px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311116768.png"
	width="535"
	height="638"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311116768_hu16267864723020953937.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311116768_hu4430659474877784389.png 1024w"
	loading="lazy"
	
		alt="image-20240731111636727"
	
	
		class="gallery-image" 
		data-flex-grow="83"
		data-flex-basis="201px"
	
></p>
<ul>
<li>编辑员工信息</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311117257.png"
	width="452"
	height="634"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311117257_hu14187772727729243847.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311117257_hu1583329157461220257.png 1024w"
	loading="lazy"
	
		alt="image-20240731111731219"
	
	
		class="gallery-image" 
		data-flex-grow="71"
		data-flex-basis="171px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311117604.png"
	width="421"
	height="217"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311117604_hu3562085637453989139.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311117604_hu4917089595985500281.png 1024w"
	loading="lazy"
	
		alt="image-20240731111739536"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="465px"
	
></p>
<h4 id="代码开发-3">代码开发
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 编辑员工信息
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param employeeDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PutMapping</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;编辑员工信息&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="nd">@RequestBody</span><span class="w"> </span><span class="n">EmployeeDTO</span><span class="w"> </span><span class="n">employeeDTO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;编辑员工信息: {}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">employeeDTO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employeeService</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">employeeDTO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 编辑员工信息
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param employeeDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">EmployeeDTO</span><span class="w"> </span><span class="n">employeeDTO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Employee</span><span class="w"> </span><span class="n">employee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Employee</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">BeanUtils</span><span class="p">.</span><span class="na">copyProperties</span><span class="p">(</span><span class="n">employeeDTO</span><span class="p">,</span><span class="w"> </span><span class="n">employee</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employee</span><span class="p">.</span><span class="na">setUpdateTime</span><span class="p">(</span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employee</span><span class="p">.</span><span class="na">setUpdateUser</span><span class="p">(</span><span class="n">BaseContext</span><span class="p">.</span><span class="na">getCurrentId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">employeeMapper</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">employee</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="功能测试-3">功能测试
</h4><h3 id="导入分类模块功能代码">导入分类模块功能代码
</h3><h4 id="需求分析和设计-4">需求分析和设计
</h4><p>产品原型</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311231534.png"
	width="1100"
	height="384"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311231534_hu3906643476604816764.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311231534_hu1600434822992212458.png 1024w"
	loading="lazy"
	
		alt="image-20240731123112488"
	
	
		class="gallery-image" 
		data-flex-grow="286"
		data-flex-basis="687px"
	
></p>
<p>业务规则：</p>
<ul>
<li>分类名称必须是<strong>唯一</strong>的</li>
<li>分类按照类型可以分为<strong>菜品分类</strong>和<strong>套餐分类</strong></li>
<li>新添加的分类状态默认为<strong>禁用</strong></li>
</ul>
<p>接口设计：</p>
<ul>
<li>新增分类</li>
<li>分类分页查询</li>
<li>根据id删除分类</li>
<li>修改分类</li>
<li>启用禁用分类</li>
<li>根据类型查询分类</li>
</ul>
<p>数据库设计（category表）：</p>
<p>category表为分类表，用于存储商品的分类信息。具体表结构如下</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>主键</td>
<td>自增</td>
</tr>
<tr>
<td>name</td>
<td>varchar(32)</td>
<td>分类名称</td>
<td>唯一</td>
</tr>
<tr>
<td>type</td>
<td>int</td>
<td>分类类型</td>
<td>1菜品分类 2套餐分类</td>
</tr>
<tr>
<td>sort</td>
<td>int</td>
<td>排序字段</td>
<td>用于分类数据的排序</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>状态</td>
<td>1启用 0禁用</td>
</tr>
<tr>
<td>create_time</td>
<td>datetime</td>
<td>创建时间</td>
<td></td>
</tr>
<tr>
<td>update_time</td>
<td>datetime</td>
<td>最后修改时间</td>
<td></td>
</tr>
<tr>
<td>create_user</td>
<td>bigint</td>
<td>创建人id</td>
<td></td>
</tr>
<tr>
<td>update_user</td>
<td>bigint</td>
<td>最后修改人id</td>
<td></td>
</tr>
</tbody>
</table></div>
<h4 id="代码导入">代码导入
</h4><h4 id="功能测试-4">功能测试
</h4><h2 id="菜品管理">菜品管理
</h2><h3 id="公共字段自动填充">公共字段自动填充🌟
</h3><h4 id="问题分析">问题分析
</h4><p>业务表中的公共字段：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311257390.png"
	width="2148"
	height="369"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311257390_hu3742016390185824621.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311257390_hu9586106551186172578.png 1024w"
	loading="lazy"
	
		alt="image-20240731125716319"
	
	
		class="gallery-image" 
		data-flex-grow="582"
		data-flex-basis="1397px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311258589.png"
	width="1063"
	height="225"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311258589_hu14162027001753364154.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311258589_hu6017281862000008400.png 1024w"
	loading="lazy"
	
		alt="image-20240731125807535"
	
	
		class="gallery-image" 
		data-flex-grow="472"
		data-flex-basis="1133px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311355214.png"
	width="1115"
	height="254"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311355214_hu868636602536072802.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311355214_hu5988109800913756222.png 1024w"
	loading="lazy"
	
		alt="image-20240731135526156"
	
	
		class="gallery-image" 
		data-flex-grow="438"
		data-flex-basis="1053px"
	
></p>
<p>问题：代码冗余、不便于后期维护</p>
<h4 id="实现思路">实现思路
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311400965.png"
	width="2181"
	height="402"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311400965_hu16980239001637235672.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311400965_hu2020811589900824537.png 1024w"
	loading="lazy"
	
		alt="image-20240731140015889"
	
	
		class="gallery-image" 
		data-flex-grow="542"
		data-flex-basis="1302px"
	
></p>
<ul>
<li>自定义注解<code>AutoFill</code>，用于标识需要进行公共字段自动填充的方法</li>
<li>自定义切面类<code>AutoFillAspect</code>，统一拦截加入了<code>AutoFill</code>注解的方法，通过反射为公共字段赋值</li>
<li>在Mapper的方法上加入<code>AutoFill</code>注解</li>
</ul>
<h4 id="代码开发-4">代码开发
</h4><h4 id="功能测试-5">功能测试
</h4><h3 id="新增菜品">新增菜品
</h3><h4 id="需求分析和设计-5">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311453641.png"
	width="1003"
	height="793"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311453641_hu12272630240233287221.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311453641_hu16022427519251953362.png 1024w"
	loading="lazy"
	
		alt="image-20240731145308435"
	
	
		class="gallery-image" 
		data-flex-grow="126"
		data-flex-basis="303px"
	
></p>
<p>业务规则：</p>
<ul>
<li>菜品名称必须是唯一的</li>
<li>菜品必须属于某个分类下，不能单独存在</li>
<li>新增菜品时可以根据情况选择菜品的口味</li>
<li>每个菜品必须对应一张图片</li>
</ul>
<p>接口设计：</p>
<ul>
<li>
<p>根据类型查询分类（已完成）</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311500087.png"
	width="507"
	height="441"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311500087_hu596055970827956249.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311500087_hu6099087618479156058.png 1024w"
	loading="lazy"
	
		alt="image-20240731150003051"
	
	
		class="gallery-image" 
		data-flex-grow="114"
		data-flex-basis="275px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311501508.png"
	width="571"
	height="567"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311501508_hu14646086407565787780.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311501508_hu10410767796341409790.png 1024w"
	loading="lazy"
	
		alt="image-20240731150103453"
	
	
		class="gallery-image" 
		data-flex-grow="100"
		data-flex-basis="241px"
	
></p>
</li>
<li>
<p>文件上传</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311501663.png"
	width="482"
	height="677"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311501663_hu9450045519789922471.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311501663_hu7943509531140190113.png 1024w"
	loading="lazy"
	
		alt="image-20240731150121623"
	
	
		class="gallery-image" 
		data-flex-grow="71"
		data-flex-basis="170px"
	
></p>
</li>
<li>
<p>新增菜品</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311504383.png"
	width="660"
	height="850"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311504383_hu16622460353814221898.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311504383_hu9514487598664333619.png 1024w"
	loading="lazy"
	
		alt="image-20240731150457335"
	
	
		class="gallery-image" 
		data-flex-grow="77"
		data-flex-basis="186px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311505211.png"
	width="432"
	height="218"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311505211_hu17695578454030528939.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311505211_hu2392508634006372456.png 1024w"
	loading="lazy"
	
		alt="image-20240731150512177"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="475px"
	
></p>
</li>
</ul>
<p>数据库设计（dish菜品表和dish_flavor口味表）：</p>
<p>dish表为菜品表，用于存储菜品的信息。具体表结构如下</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>主键</td>
<td>自增</td>
</tr>
<tr>
<td>name</td>
<td>varchar(32)</td>
<td>菜品名称</td>
<td>唯一</td>
</tr>
<tr>
<td>category_id</td>
<td>bigint</td>
<td>分类id</td>
<td>逻辑外键</td>
</tr>
<tr>
<td>price</td>
<td>decimal(10,2)</td>
<td>菜品价格</td>
<td></td>
</tr>
<tr>
<td>image</td>
<td>varchar(255)</td>
<td>图片路径</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td>varchar(255)</td>
<td>菜品描述</td>
<td></td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>售卖状态</td>
<td>1起售 0停售</td>
</tr>
<tr>
<td>create_time</td>
<td>datetime</td>
<td>创建时间</td>
<td></td>
</tr>
<tr>
<td>update_time</td>
<td>datetime</td>
<td>最后修改时间</td>
<td></td>
</tr>
<tr>
<td>create_user</td>
<td>bigint</td>
<td>创建人id</td>
<td></td>
</tr>
<tr>
<td>update_user</td>
<td>bigint</td>
<td>最后修改人id</td>
<td></td>
</tr>
</tbody>
</table></div>
<p>dish_flavor表为菜品口味表，用于存储菜品的口味信息。具体表结构如下</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>主键</td>
<td>自增</td>
</tr>
<tr>
<td>dish_id</td>
<td>bigint</td>
<td>菜品id</td>
<td>逻辑外键</td>
</tr>
<tr>
<td>name</td>
<td>varchar(32)</td>
<td>口味名称</td>
<td></td>
</tr>
<tr>
<td>value</td>
<td>varchar(255)</td>
<td>口味值</td>
<td></td>
</tr>
</tbody>
</table></div>
<h4 id="代码开发-5">代码开发
</h4><p>开发文件上传接口：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311519132.png"
	width="1913"
	height="276"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311519132_hu8369701754774338833.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311519132_hu8674908201855034382.png 1024w"
	loading="lazy"
	
		alt="image-20240731151934082"
	
	
		class="gallery-image" 
		data-flex-grow="693"
		data-flex-basis="1663px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311554732.png"
	width="1527"
	height="585"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311554732_hu11350405858453521539.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202407311554732_hu5338797344860601007.png 1024w"
	loading="lazy"
	
		alt="image-20240731155431636"
	
	
		class="gallery-image" 
		data-flex-grow="261"
		data-flex-basis="626px"
	
></p>
<h4 id="功能测试-6">功能测试
</h4><h3 id="菜品分页查询">菜品分页查询
</h3><h4 id="需求分析和设计-6">需求分析和设计
</h4><p>产品原型</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010920411.png"
	width="1087"
	height="739"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010920411_hu13506480809210536489.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010920411_hu3300759023585771744.png 1024w"
	loading="lazy"
	
		alt="image-20240801092032347"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="353px"
	
></p>
<p>业务规则</p>
<ul>
<li>根据页码展示菜品信息</li>
<li>每页展示10条数据</li>
<li>分页查询时可以根据需要输入菜品名称、菜品分类、菜品状态进行查询</li>
</ul>
<p>接口设计</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010922120.png"
	width="354"
	height="481"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010922120_hu5099723128446103128.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010922120_hu14191469385507878282.png 1024w"
	loading="lazy"
	
		alt="image-20240801092241079"
	
	
		class="gallery-image" 
		data-flex-grow="73"
		data-flex-basis="176px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010923713.png"
	width="606"
	height="560"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010923713_hu10165976490612330439.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010923713_hu11081136825409022389.png 1024w"
	loading="lazy"
	
		alt="image-20240801092310661"
	
	
		class="gallery-image" 
		data-flex-grow="108"
		data-flex-basis="259px"
	
></p>
<h4 id="代码开发-6">代码开发
</h4><p>根据菜品分页查询接口定义设计对应的DTO：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010926008.png"
	width="2028"
	height="717"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010926008_hu14393637388282998118.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010926008_hu6740039254190154611.png 1024w"
	loading="lazy"
	
		alt="image-20240801092610922"
	
	
		class="gallery-image" 
		data-flex-grow="282"
		data-flex-basis="678px"
	
></p>
<p>根据菜品分页查询接口定义设计对应的VO：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010926725.png"
	width="2138"
	height="894"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010926725_hu10143160819900712478.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010926725_hu13672869082089172265.png 1024w"
	loading="lazy"
	
		alt="image-20240801092637618"
	
	
		class="gallery-image" 
		data-flex-grow="239"
		data-flex-basis="573px"
	
></p>
<h4 id="功能测试-7">功能测试
</h4><h3 id="删除菜品">删除菜品
</h3><h4 id="需求分析和设计-7">需求分析和设计
</h4><p>产品原型</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010955654.png"
	width="1095"
	height="736"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010955654_hu2207228635770456162.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010955654_hu4026548317738901730.png 1024w"
	loading="lazy"
	
		alt="image-20240801095549599"
	
	
		class="gallery-image" 
		data-flex-grow="148"
		data-flex-basis="357px"
	
></p>
<p>业务规则：</p>
<ul>
<li>可以一次删除一个菜品，也可以批量删除菜品</li>
<li>起售中的菜品不能删除</li>
<li>被套餐关联的菜品不能删除</li>
<li>删除菜品后，关联的口味数据也需要删除掉</li>
</ul>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010959754.png"
	width="436"
	height="572"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010959754_hu1627672006156172231.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408010959754_hu4492315382727234408.png 1024w"
	loading="lazy"
	
		alt="image-20240801095951713"
	
	
		class="gallery-image" 
		data-flex-grow="76"
		data-flex-basis="182px"
	
></p>
<p>数据库设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011000856.png"
	width="1527"
	height="902"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011000856_hu17902701317440831154.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011000856_hu2240342770759594551.png 1024w"
	loading="lazy"
	
		alt="image-20240801100043756"
	
	
		class="gallery-image" 
		data-flex-grow="169"
		data-flex-basis="406px"
	
></p>
<h4 id="代码开发-7">代码开发
</h4><h4 id="功能测试-8">功能测试
</h4><h3 id="修改菜品">修改菜品
</h3><h4 id="需求分析和设计-8">需求分析和设计
</h4><p>产品原型</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011042789.png"
	width="1092"
	height="786"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011042789_hu744713178542062424.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011042789_hu12853756611338839054.png 1024w"
	loading="lazy"
	
		alt="image-20240801104243735"
	
	
		class="gallery-image" 
		data-flex-grow="138"
		data-flex-basis="333px"
	
></p>
<p>接口设计：</p>
<ul>
<li>
<p>根据id查询商品</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011045258.png"
	width="256"
	height="343"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011045258_hu17041453050807908912.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011045258_hu16674443554657541968.png 1024w"
	loading="lazy"
	
		alt="image-20240801104528223"
	
	
		class="gallery-image" 
		data-flex-grow="74"
		data-flex-basis="179px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011045120.png"
	width="567"
	height="725"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011045120_hu2228048060692397682.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011045120_hu12936364844696073569.png 1024w"
	loading="lazy"
	
		alt="image-20240801104545075"
	
	
		class="gallery-image" 
		data-flex-grow="78"
		data-flex-basis="187px"
	
></p>
</li>
<li>
<p>根据类型查询分类（已实现）</p>
</li>
<li>
<p>文件上传（已实现）</p>
</li>
<li>
<p>修改商品</p>
</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011046120.png"
	width="416"
	height="347"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011046120_hu5068128702246986527.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011046120_hu4188094849195767495.png 1024w"
	loading="lazy"
	
		alt="image-20240801104643083"
	
	
		class="gallery-image" 
		data-flex-grow="119"
		data-flex-basis="287px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011046442.png"
	width="502"
	height="522"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011046442_hu7846812092949042584.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408011046442_hu404008226462436263.png 1024w"
	loading="lazy"
	
		alt="image-20240801104652405"
	
	
		class="gallery-image" 
		data-flex-grow="96"
		data-flex-basis="230px"
	
></p>
<h4 id="代码开发-8">代码开发
</h4><h4 id="功能测试-9">功能测试
</h4><h2 id="店铺营业状态设置">店铺营业状态设置
</h2><h3 id="redis入门">Redis入门
</h3><h4 id="redis简介">Redis简介
</h4><p>Redis是一个基于<strong>内存</strong>的key-value结构数据库。</p>
<ul>
<li>基于内存存储，读写性能高</li>
<li>适合存储热点数据（热点商品、资讯、新闻）</li>
<li>企业应用广泛</li>
</ul>
<p>官网：https://redis.io/</p>
<p>中文网：https://www.redis.net.cn/</p>
<h4 id="redis下载与安装">Redis下载与安装
</h4><h4 id="redis服务启动与停止">Redis服务启动与停止
</h4><h3 id="redis数据类型">Redis数据类型
</h3><h4 id="5种常用数据类型介绍">5种常用数据类型介绍
</h4><p>Redis存储的是key-value结构的数据，其中key是字符串类型，value有5种常用的数据类型：</p>
<ul>
<li>
<p>字符串 string</p>
<p>普通字符串，Redis中最简单的数据类型</p>
</li>
<li>
<p>哈希 hash</p>
<p>也叫散列，类似于Java中的HashMap结构</p>
</li>
<li>
<p>列表 list</p>
<p>按照插入顺序排序，可以有重复元素，类似于Java中的LinkedList</p>
</li>
<li>
<p>集合 set</p>
<p>无序集合，没有重复元素，类似于Java中的HashSet</p>
</li>
<li>
<p>有序集合 sorted set/zset</p>
<p>集合中每个元素关联一个分数（score），Redis根据分数升序排序，没有重复元素</p>
</li>
</ul>
<h4 id="各种数据类型的特点">各种数据类型的特点
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408012141827.png"
	width="1039"
	height="1025"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408012141827_hu3409342092946170244.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408012141827_hu17713544379932139933.png 1024w"
	loading="lazy"
	
		alt="image-20240801214152710"
	
	
		class="gallery-image" 
		data-flex-grow="101"
		data-flex-basis="243px"
	
></p>
<h3 id="redis常用命令">Redis常用命令
</h3><h4 id="字符串操作命令">字符串操作命令
</h4><ul>
<li>SET key value 设置指定key的值</li>
<li>GET key 获取指定key的值</li>
<li>SETEX key seconds value 设置指定key的值，并将key的过期时间设为seconds秒 &mdash;&gt; 短信验证码</li>
<li>SETNX key value 只有在key不存在时设置key的值</li>
</ul>
<h4 id="哈希操作命令">哈希操作命令
</h4><p>Redis hash 是一个String类型的 field 和 value 的映射表，hash特别适合用于存储对象，常用命令：</p>
<ul>
<li>HSET key field value 将哈希表 key 中的字段 field 的值为 value</li>
<li>HGET key field 获取存储在哈希表中指定字段的值</li>
<li>HDEL key field 删除存储在哈希表中的指定字段</li>
<li>HKEYS key 获取哈希表中所有字段</li>
<li>HVALS key 获取哈希表中所有值</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408012208023.png"
	width="845"
	height="263"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408012208023_hu9081556977147814607.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408012208023_hu10110300406990336570.png 1024w"
	loading="lazy"
	
		alt="image-20240801220851970"
	
	
		class="gallery-image" 
		data-flex-grow="321"
		data-flex-basis="771px"
	
></p>
<h4 id="列表操作命令">列表操作命令
</h4><p>Redis列表是简单的字符串列表，按照插入顺序排序，常用命令：</p>
<ul>
<li>LPUSH key value1 [value2] 将一个或多个值插入到列表头部</li>
<li>LRANGE key start stop 获取列表指定范围内的元素</li>
<li>RPOP key 移除并获取列表最后一个元素</li>
<li>LLEN key 获取列表长度</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021053916.png"
	width="950"
	height="229"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021053916_hu4864748083146537023.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021053916_hu7364684931237049944.png 1024w"
	loading="lazy"
	
		alt="image-20240802105339863"
	
	
		class="gallery-image" 
		data-flex-grow="414"
		data-flex-basis="995px"
	
></p>
<h4 id="集合操作命令">集合操作命令
</h4><p>Redis set 是 String 类型的无序集合。集合成员是唯一的，集合中不能出现重复的数据，常用命令：</p>
<ul>
<li>SADD key member1 [member2] 向集合添加一个或多个成员</li>
<li>SMEMBERS key 返回集合中所有的成员</li>
<li>SCARD key 获取集合的成员数</li>
<li>SINTER key1 [key2] 返回给定的所有集合的交集</li>
<li>SUNION key1 [key2] 返回所有给定集合的并集</li>
<li>SREM key member1 [member2] 删除集合中一个或多个成员</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021105755.png"
	width="796"
	height="300"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021105755_hu15888641657259091799.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021105755_hu15358015592974398285.png 1024w"
	loading="lazy"
	
		alt="image-20240802110520705"
	
	
		class="gallery-image" 
		data-flex-grow="265"
		data-flex-basis="636px"
	
></p>
<h4 id="有序集合操作命令">有序集合操作命令
</h4><p>Redis的有序集合是String类型元素的集合，且不允许有重复成员。每个元素都会关联一个double类型的分数。常用命令：</p>
<ul>
<li>ZADD key score1 member1 [score2 member2] 向有序集合添加一个或多个成员</li>
<li>ZRANGE key start stop [WITHSCORES] 通过索引区间返回有序集合中指定区间内的成员</li>
<li>ZINCRBY key increment member 有序集合中对指定成员的分数加上增量increment</li>
<li>ZREM key member [member&hellip; ] 移除有序集合中的一个或多个成员</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021125487.png"
	width="892"
	height="351"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021125487_hu11057177747409945181.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021125487_hu6520936480453804304.png 1024w"
	loading="lazy"
	
		alt="image-20240802112534431"
	
	
		class="gallery-image" 
		data-flex-grow="254"
		data-flex-basis="609px"
	
></p>
<h4 id="通用命令">通用命令
</h4><p>Redis的通用命令是不分数据类型的，都可以使用的命令：</p>
<ul>
<li>KEYS pattern 查找所有符合给定模式（pattern）的key</li>
<li>EXISTS key 检查给定key是否存在</li>
<li>TYPE key 返回key所存储的值的类型</li>
<li>DEL key 该命令用于在key存在时删除key</li>
</ul>
<h3 id="在java中操作redis">在Java中操作Redis
</h3><h4 id="redis的java客户端">Redis的Java客户端
</h4><p>Redis的Java客户端很多，常用的几种：</p>
<ul>
<li>
<p>Jedis</p>
</li>
<li>
<p>Lettuce</p>
</li>
<li>
<p>Spring Data Redis</p>
<p>是Spring的一部分，对Redis底层开发包进行了高度封装。在Spring项目中，可以使用Spring Data Redis来简化操作。</p>
</li>
</ul>
<h4 id="spring-data-redis使用方式">Spring Data Redis使用方式
</h4><p>操作步骤：</p>
<ol>
<li>
<p>导入Spring Data Redis 的Maven坐标</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021422156.png"
	width="1262"
	height="184"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021422156_hu5605650319797379486.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021422156_hu13562134232461325771.png 1024w"
	loading="lazy"
	
		alt="image-20240802142232095"
	
	
		class="gallery-image" 
		data-flex-grow="685"
		data-flex-basis="1646px"
	
></p>
</li>
<li>
<p>配置Redis数据源</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021422034.png"
	width="1258"
	height="220"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021422034_hu632604030122827066.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021422034_hu15294577434904315363.png 1024w"
	loading="lazy"
	
		alt="image-20240802142243974"
	
	
		class="gallery-image" 
		data-flex-grow="571"
		data-flex-basis="1372px"
	
></p>
</li>
<li>
<p>编写配置类，创建RedisTemplate对象</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021423024.png"
	width="1473"
	height="560"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021423024_hu10133110670044170720.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021423024_hu6870463888464614909.png 1024w"
	loading="lazy"
	
		alt="image-20240802142326934"
	
	
		class="gallery-image" 
		data-flex-grow="263"
		data-flex-basis="631px"
	
></p>
</li>
<li>
<p>通过RedisTemplate对象操作Redis</p>
</li>
</ol>
<h3 id="店铺营业状态">店铺营业状态
</h3><h4 id="需求分析和设计-9">需求分析和设计
</h4><p>产品原型</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021527293.png"
	width="1145"
	height="826"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021527293_hu15348883140514274153.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021527293_hu6122992288500584997.png 1024w"
	loading="lazy"
	
		alt="image-20240802152705228"
	
	
		class="gallery-image" 
		data-flex-grow="138"
		data-flex-basis="332px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021527764.png"
	width="454"
	height="336"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021527764_hu176343712915497841.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021527764_hu1260558996914056812.png 1024w"
	loading="lazy"
	
		alt="image-20240802152717725"
	
	
		class="gallery-image" 
		data-flex-grow="135"
		data-flex-basis="324px"
	
></p>
<p>接口设计：</p>
<ul>
<li>设置营业状态</li>
<li>管理端查询营业状态</li>
<li>用户端查询营业状态</li>
</ul>
<p>本项目约定：</p>
<ul>
<li><strong>管理端</strong>发出的请求，统一使用<code>/admin</code>作为前缀</li>
<li><strong>用户端</strong>发出的请求，统一使用<code>/user</code>作为前缀</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021533242.png"
	width="445"
	height="740"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021533242_hu13600499487281321239.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021533242_hu4265729218895464915.png 1024w"
	loading="lazy"
	
		alt="image-20240802153330198"
	
	
		class="gallery-image" 
		data-flex-grow="60"
		data-flex-basis="144px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021534207.png"
	width="605"
	height="512"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021534207_hu10453652781213001455.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021534207_hu17455587407246707959.png 1024w"
	loading="lazy"
	
		alt="image-20240802153450159"
	
	
		class="gallery-image" 
		data-flex-grow="118"
		data-flex-basis="283px"
	
></p>
<p>营业状态数据存储方式：基于Redis的字符串来进行存储</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021538742.png"
	width="596"
	height="252"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021538742_hu7862032520749062915.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408021538742_hu7576620016776280527.png 1024w"
	loading="lazy"
	
		alt="image-20240802153802698"
	
	
		class="gallery-image" 
		data-flex-grow="236"
		data-flex-basis="567px"
	
></p>
<h4 id="代码开发-9">代码开发
</h4><h4 id="功能测试-10">功能测试
</h4><h2 id="微信登录商品浏览">微信登录、商品浏览
</h2><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031625309.png"
	width="2071"
	height="1070"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031625309_hu10238463582419661593.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031625309_hu8710894783154955208.png 1024w"
	loading="lazy"
	
		alt="image-20240803162559100"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="464px"
	
></p>
<h3 id="httpclient">HttpClient🆕
</h3><h4 id="介绍-1">介绍
</h4><p>HttpClient 是Apache Jakarta Common下的子项目，可以用来提供高效的、最新的、功能丰富的支持 HTTP 协议的客户端编程工具包，并且它支持 HTTP 协议最新的版本和建议。</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031629580.png"
	width="1372"
	height="241"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031629580_hu875191511817464436.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031629580_hu7992382114809097820.png 1024w"
	loading="lazy"
	
		alt="image-20240803162925521"
	
	
		class="gallery-image" 
		data-flex-grow="569"
		data-flex-basis="1366px"
	
></p>
<p>核心API：</p>
<ul>
<li>HttpClient</li>
<li>HttpClients</li>
<li>CloseableHttpClient</li>
<li>HttpGet</li>
<li>HttpPost</li>
</ul>
<p>发送请求步骤：</p>
<ul>
<li>创建HttpClient对象</li>
<li>创建Http请求对象 &mdash;&gt; HttpGet/HttpPost</li>
<li>调用HttpClient的execute方法发送请求</li>
</ul>
<h4 id="入门案例">入门案例
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">		</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 测试通过HttpClient发送GET方式请求
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">testGET</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//创建Httpclient对象</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CloseableHttpClient</span><span class="w"> </span><span class="n">httpClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpClients</span><span class="p">.</span><span class="na">createDefault</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//创建请求对象</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">HttpGet</span><span class="w"> </span><span class="n">httpGet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpGet</span><span class="p">(</span><span class="s">&#34;http://localhost:8080/user/shop/status&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//发送请求，并接受响应结果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CloseableHttpResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">httpClient</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="n">httpGet</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//获取服务端返回的状态码</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">statusCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">getStatusLine</span><span class="p">().</span><span class="na">getStatusCode</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;服务端返回的状态码为：&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">statusCode</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">HttpEntity</span><span class="w"> </span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">getEntity</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EntityUtils</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">entity</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;服务端返回的数据为：&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">body</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//关闭资源</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">response</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">httpClient</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 测试通过HttpClient发送POST请求
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">testPost</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//创建Httpclient对象</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CloseableHttpClient</span><span class="w"> </span><span class="n">httpClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpClients</span><span class="p">.</span><span class="na">createDefault</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//创建请求对象</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">HttpPost</span><span class="w"> </span><span class="n">httpPost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpPost</span><span class="p">(</span><span class="s">&#34;http://localhost:8080/admin/employee/login&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JSONObject</span><span class="w"> </span><span class="n">jsonObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JSONObject</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">jsonObject</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;username&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;admin&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">jsonObject</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;password&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;123456&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">StringEntity</span><span class="w"> </span><span class="n">entity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringEntity</span><span class="p">(</span><span class="n">jsonObject</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//指定请求的编码方式</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">entity</span><span class="p">.</span><span class="na">setContentEncoding</span><span class="p">(</span><span class="s">&#34;utf-8&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//数据格式</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">entity</span><span class="p">.</span><span class="na">setContentType</span><span class="p">(</span><span class="s">&#34;application/json&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">httpPost</span><span class="p">.</span><span class="na">setEntity</span><span class="p">(</span><span class="n">entity</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//发送请求</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CloseableHttpResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">httpClient</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="n">httpPost</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//解析返回结果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">statusCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">getStatusLine</span><span class="p">().</span><span class="na">getStatusCode</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;响应码为：&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">statusCode</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">HttpEntity</span><span class="w"> </span><span class="n">entity1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="na">getEntity</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EntityUtils</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">entity1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;响应数据为：&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">body</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//关闭资源</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">response</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">httpClient</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="微信小程序开发">微信小程序开发
</h3><h4 id="介绍-2">介绍
</h4><h4 id="准备工作">准备工作
</h4><h4 id="入门案例-1">入门案例
</h4><p>操作步骤：</p>
<ul>
<li>
<p>了解微信小程序目录结构</p>
<p>小程序包含一个描述整体程序的 app 和多个描述各自页面的 page。一个小程序主体部分由三个文件组成，必须放在项目的根目录，如下：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031737506.png"
	width="1955"
	height="625"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031737506_hu8877844682298545556.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031737506_hu17032043267833092659.png 1024w"
	loading="lazy"
	
		alt="image-20240803173706418"
	
	
		class="gallery-image" 
		data-flex-grow="312"
		data-flex-basis="750px"
	
></p>
<p>一个小程序页面由四个文件组成：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031740878.png"
	width="1977"
	height="738"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031740878_hu2040478692366444212.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031740878_hu18192876858223654085.png 1024w"
	loading="lazy"
	
		alt="image-20240803174029789"
	
	
		class="gallery-image" 
		data-flex-grow="267"
		data-flex-basis="642px"
	
></p>
</li>
<li>
<p>编写小程序代码</p>
</li>
<li>
<p>编译小程序</p>
</li>
</ul>
<h3 id="微信登录">微信登录
</h3><h4 id="导入小程序代码">导入小程序代码
</h4><h4 id="微信登录流程">微信登录流程
</h4><p>官网：https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031900973.png"
	width="694"
	height="666"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031900973_hu6147381575351488193.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031900973_hu15150031101361022289.png 1024w"
	loading="lazy"
	
		alt="image-20240803190028917"
	
	
		class="gallery-image" 
		data-flex-grow="104"
		data-flex-basis="250px"
	
></p>
<h4 id="需求分析和设计-10">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031902280.png"
	width="1205"
	height="936"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031902280_hu4912775893240111014.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031902280_hu7782465266286169431.png 1024w"
	loading="lazy"
	
		alt="image-20240803190237210"
	
	
		class="gallery-image" 
		data-flex-grow="128"
		data-flex-basis="308px"
	
></p>
<p>业务规则：</p>
<ul>
<li>基于微信登录实现小程序的登录功能</li>
<li>如果是新用户需要自动完成注册</li>
</ul>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031905225.png"
	width="1911"
	height="858"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031905225_hu199740853481836492.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031905225_hu4894803119186861904.png 1024w"
	loading="lazy"
	
		alt="image-20240803190529128"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="534px"
	
></p>
<p>数据库设计（user表）：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031907123.png"
	width="1818"
	height="872"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031907123_hu17376329622431005200.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031907123_hu3542458562524057509.png 1024w"
	loading="lazy"
	
		alt="image-20240803190714040"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="500px"
	
></p>
<h4 id="代码开发-10">代码开发
</h4><p>配置微信登录所需配置项：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031959443.png"
	width="2259"
	height="840"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031959443_hu5229712043448925015.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031959443_hu963355934036824618.png 1024w"
	loading="lazy"
	
		alt="image-20240803195925333"
	
	
		class="gallery-image" 
		data-flex-grow="268"
		data-flex-basis="645px"
	
></p>
<p>配置为微信用户生成jwt令牌时使用的配置项：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031959291.png"
	width="929"
	height="979"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031959291_hu15864740550151705818.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408031959291_hu2169712662582967123.png 1024w"
	loading="lazy"
	
		alt="image-20240803195959210"
	
	
		class="gallery-image" 
		data-flex-grow="94"
		data-flex-basis="227px"
	
></p>
<h4 id="功能测试-11">功能测试
</h4><h3 id="导入商品浏览功能代码">导入商品浏览功能代码
</h3><h4 id="需求分析和设计-11">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032106963.png"
	width="2270"
	height="959"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032106963_hu14562571627411027446.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032106963_hu13956800790550894199.png 1024w"
	loading="lazy"
	
		alt="image-20240803210624703"
	
	
		class="gallery-image" 
		data-flex-grow="236"
		data-flex-basis="568px"
	
></p>
<p>接口设计：</p>
<ul>
<li>
<p>查询分类</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032110870.png"
	width="2046"
	height="1145"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032110870_hu6447752502890057590.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032110870_hu12078678316712893704.png 1024w"
	loading="lazy"
	
		alt="image-20240803211011751"
	
	
		class="gallery-image" 
		data-flex-grow="178"
		data-flex-basis="428px"
	
></p>
</li>
<li>
<p>根据分类id查询菜品</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032112611.png"
	width="1536"
	height="1188"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032112611_hu8268199439937324941.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032112611_hu4162686753168873735.png 1024w"
	loading="lazy"
	
		alt="image-20240803211227483"
	
	
		class="gallery-image" 
		data-flex-grow="129"
		data-flex-basis="310px"
	
></p>
</li>
<li>
<p>根据分类id查询套餐</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032113071.png"
	width="1626"
	height="1119"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032113071_hu16842690140447744633.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032113071_hu8901027514047672737.png 1024w"
	loading="lazy"
	
		alt="image-20240803211314972"
	
	
		class="gallery-image" 
		data-flex-grow="145"
		data-flex-basis="348px"
	
></p>
</li>
<li>
<p>根据套餐id查询包含的菜品</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032116416.png"
	width="995"
	height="1202"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032116416_hu11110846913605021992.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408032116416_hu14384954506041797010.png 1024w"
	loading="lazy"
	
		alt="image-20240803211603333"
	
	
		class="gallery-image" 
		data-flex-grow="82"
		data-flex-basis="198px"
	
></p>
</li>
</ul>
<h4 id="代码导入-1">代码导入
</h4><h4 id="功能测试-12">功能测试
</h4><h2 id="缓存商品购物车">缓存商品、购物车
</h2><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041445961.png"
	width="2078"
	height="1068"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041445961_hu18277422659191741181.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041445961_hu1262220779121738701.png 1024w"
	loading="lazy"
	
		alt="image-20240804144536747"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="466px"
	
></p>
<h3 id="缓存菜品">缓存菜品
</h3><h4 id="问题说明">问题说明
</h4><p>用户端小程序展示的菜品数据都是通过查询数据库获得，如果用户端访问量比较大，数据库访问压力随之增大。</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041453609.png"
	width="2147"
	height="730"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041453609_hu16369993652393165244.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041453609_hu3570714437891162079.png 1024w"
	loading="lazy"
	
		alt="image-20240804145328503"
	
	
		class="gallery-image" 
		data-flex-grow="294"
		data-flex-basis="705px"
	
></p>
<h4 id="实现思路-1">实现思路
</h4><p>通过Redis来缓存菜品数据，减少数据库查询操作。</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041454035.png"
	width="2315"
	height="621"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041454035_hu1957818962571213239.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041454035_hu15468296106242206627.png 1024w"
	loading="lazy"
	
		alt="image-20240804145449960"
	
	
		class="gallery-image" 
		data-flex-grow="372"
		data-flex-basis="894px"
	
></p>
<p>缓存逻辑分析：</p>
<ul>
<li>
<p>每个分类下的菜品保存一份缓存数据</p>
<p><img src="/"
	
	
	
	loading="lazy"
	
		alt="image-20240804145939082"
	
	
></p>
</li>
<li>
<p>数据库中菜品数据有变更时清理缓存数据</p>
</li>
</ul>
<h4 id="代码开发-11">代码开发
</h4><p>修改管理端接口 DishController 的相关方法，加入清理缓存的逻辑，需要改造的方法:</p>
<ul>
<li>新增菜品</li>
<li>修改菜品</li>
<li>批量删除菜品</li>
<li>起售、停售菜品</li>
</ul>
<h4 id="功能测试-13">功能测试
</h4><h3 id="缓存套餐">缓存套餐
</h3><h4 id="spring-cache">Spring Cache⭐
</h4><p>Spring Cache 是一个框架，实现了基于<strong>注解</strong>的缓存功能，只需要简单地加一个注解，就能实现缓存功能。</p>
<p>Spring Cache 提供了一层抽象，底层可以切换不同的缓存实现，例如:</p>
<ul>
<li>EHCache</li>
<li>Caffeine</li>
<li>Redis</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041600469.png"
	width="2033"
	height="321"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041600469_hu12997818719253262925.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041600469_hu141086468482005085.png 1024w"
	loading="lazy"
	
		alt="image-20240804160032385"
	
	
		class="gallery-image" 
		data-flex-grow="633"
		data-flex-basis="1520px"
	
></p>
<p>常用注解：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041601808.png"
	width="2061"
	height="450"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041601808_hu11990716352182893906.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041601808_hu9077266045513591218.png 1024w"
	loading="lazy"
	
		alt="image-20240804160124679"
	
	
		class="gallery-image" 
		data-flex-grow="458"
		data-flex-basis="1099px"
	
></p>
<p>在启动类上添加<code>@EnableCaching</code>注解</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Slf4j</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@SpringBootApplication</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@EnableCaching</span><span class="w"> </span><span class="c1">//开启缓存注解功能</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CacheDemoApplication</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">CacheDemoApplication</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="n">args</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;项目启动成功...&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在controller上使用<code>@Cacheable、@Cacheput、@CacheEvict</code>注解</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041652161.png"
	width="807"
	height="610"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041652161_hu7802152177395435222.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408041652161_hu9197608759838752513.png 1024w"
	loading="lazy"
	
		alt="image-20240804165233104"
	
	
		class="gallery-image" 
		data-flex-grow="132"
		data-flex-basis="317px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@RestController</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&#34;/user&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Slf4j</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserController</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserMapper</span><span class="w"> </span><span class="n">userMapper</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PostMapping</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@CachePut</span><span class="p">(</span><span class="n">cacheNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;userCache&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;#user.id&#34;</span><span class="p">)</span><span class="w"> </span><span class="c1">//如果使用SpringCache缓存数据，key的生成：userCache::2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="nd">@RequestBody</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">user</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">user</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@DeleteMapping</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@CacheEvict</span><span class="p">(</span><span class="n">cacheNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;userCache&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;#id&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteById</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userMapper</span><span class="p">.</span><span class="na">deleteById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nd">@DeleteMapping</span><span class="p">(</span><span class="s">&#34;/delAll&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@CacheEvict</span><span class="p">(</span><span class="n">cacheNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;userCache&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">allEntries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="c1">//删除userCache下的所有缓存</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteAll</span><span class="p">(){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">userMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@GetMapping</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Cacheable</span><span class="p">(</span><span class="n">cacheNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;userCache&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;#id&#34;</span><span class="p">)</span><span class="w"> </span><span class="c1">//key的生成：userCache::10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="nf">getById</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">User</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userMapper</span><span class="p">.</span><span class="na">getById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">user</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="实现思路-2">实现思路
</h4><p>具体的实现思路如下：</p>
<ul>
<li>导入SpringCache和Redis相关Maven坐标</li>
<li>在启动类上加入@EnableCache注解，开启缓存注解功能</li>
<li>在用户端接口SetmealController的<strong>list</strong>方法上加入@Cacheable注解</li>
<li>在管理端接口SetmealController的<strong>save、delete、update、startOrStop</strong>等方法上加入@CacheEvict注解</li>
</ul>
<h4 id="代码开发-12">代码开发
</h4><h4 id="功能测试-14">功能测试
</h4><h3 id="添加购物车">添加购物车
</h3><h4 id="需求分析和设计-12">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051033749.png"
	width="1815"
	height="910"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051033749_hu168977718311147788.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051033749_hu3673743148346672020.png 1024w"
	loading="lazy"
	
		alt="image-20240805103352522"
	
	
		class="gallery-image" 
		data-flex-grow="199"
		data-flex-basis="478px"
	
></p>
<p>接口设计：</p>
<ul>
<li>请求方式：POST</li>
<li>请求路径：/user/shoppingCart/add</li>
<li>请求参数：套餐id、菜品id、口味</li>
<li>返回结果：code、data、msg</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051037498.png"
	width="1679"
	height="981"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051037498_hu3182734810747329685.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051037498_hu11857655268178278687.png 1024w"
	loading="lazy"
	
		alt="image-20240805103704404"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="410px"
	
></p>
<p>数据库设计：</p>
<ul>
<li>作用：暂时存放所选商品的地方</li>
<li>选的什么商品</li>
<li>每个商品买了几个</li>
<li>不同用户的购物车需要区分开</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051039084.png"
	width="1870"
	height="1031"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051039084_hu4204868103391656366.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051039084_hu134569720795042949.png 1024w"
	loading="lazy"
	
		alt="image-20240805103944991"
	
	
		class="gallery-image" 
		data-flex-grow="181"
		data-flex-basis="435px"
	
></p>
<h4 id="代码开发-13">代码开发
</h4><h4 id="功能测试-15">功能测试
</h4><h3 id="查看购物车">查看购物车
</h3><h4 id="需求分析和设计-13">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051413129.png"
	width="585"
	height="1004"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051413129_hu12850322950459134653.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051413129_hu10819749072569360830.png 1024w"
	loading="lazy"
	
		alt="image-20240805141318029"
	
	
		class="gallery-image" 
		data-flex-grow="58"
		data-flex-basis="139px"
	
></p>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051413569.png"
	width="1883"
	height="1038"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051413569_hu1349339373075769387.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051413569_hu1185881259613696024.png 1024w"
	loading="lazy"
	
		alt="image-20240805141335472"
	
	
		class="gallery-image" 
		data-flex-grow="181"
		data-flex-basis="435px"
	
></p>
<h4 id="代码开发-14">代码开发
</h4><h4 id="功能测试-16">功能测试
</h4><h3 id="清空购物车">清空购物车
</h3><h4 id="需求分析和设计-14">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051421945.png"
	width="587"
	height="992"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051421945_hu8554752105111565598.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051421945_hu5248700168933693514.png 1024w"
	loading="lazy"
	
		alt="image-20240805142137852"
	
	
		class="gallery-image" 
		data-flex-grow="59"
		data-flex-basis="142px"
	
></p>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051422434.png"
	width="925"
	height="950"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051422434_hu16630992895922493630.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408051422434_hu5923164333116647347.png 1024w"
	loading="lazy"
	
		alt="image-20240805142244369"
	
	
		class="gallery-image" 
		data-flex-grow="97"
		data-flex-basis="233px"
	
></p>
<h4 id="功能测试-17">功能测试
</h4><h4 id="代码开发-15">代码开发
</h4><h2 id="用户下单订单支付">用户下单、订单支付
</h2><h3 id="导入地址簿功能代码">导入地址簿功能代码
</h3><h4 id="需求分析和设计-15">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061041050.png"
	width="1674"
	height="872"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061041050_hu13919001187249671848.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061041050_hu17515710464163559282.png 1024w"
	loading="lazy"
	
		alt="image-20240806104116944"
	
	
		class="gallery-image" 
		data-flex-grow="191"
		data-flex-basis="460px"
	
></p>
<p>业务功能：</p>
<ul>
<li>查询地址列表</li>
<li>新增地址</li>
<li>修改地址</li>
<li>删除地址</li>
<li>设置默认地址</li>
<li>查询默认地址</li>
</ul>
<p>接口设计：</p>
<ul>
<li>新增地址</li>
<li>查询当前登录用户的所有地址信息</li>
<li>查询默认地址</li>
<li>根据id删除地址</li>
<li>根据id修改地址</li>
<li>根据id查询地址</li>
<li>设置默认地址</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061045641.png"
	width="2348"
	height="992"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061045641_hu9727495215724182927.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061045641_hu10175957063176006330.png 1024w"
	loading="lazy"
	
		alt="image-20240806104551525"
	
	
		class="gallery-image" 
		data-flex-grow="236"
		data-flex-basis="568px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061047593.png"
	width="1975"
	height="1076"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061047593_hu11469811780106702920.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061047593_hu15429602480607684916.png 1024w"
	loading="lazy"
	
		alt="image-20240806104707457"
	
	
		class="gallery-image" 
		data-flex-grow="183"
		data-flex-basis="440px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061048765.png"
	width="1838"
	height="1072"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061048765_hu12738260375135396550.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061048765_hu7311657593436259132.png 1024w"
	loading="lazy"
	
		alt="image-20240806104800655"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="411px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061048441.png"
	width="2360"
	height="1007"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061048441_hu533746923148765293.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061048441_hu13623684526452655591.png 1024w"
	loading="lazy"
	
		alt="image-20240806104825323"
	
	
		class="gallery-image" 
		data-flex-grow="234"
		data-flex-basis="562px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061048757.png"
	width="1438"
	height="1056"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061048757_hu6486471688919058256.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061048757_hu5060324416973236708.png 1024w"
	loading="lazy"
	
		alt="image-20240806104850674"
	
	
		class="gallery-image" 
		data-flex-grow="136"
		data-flex-basis="326px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061049890.png"
	width="1871"
	height="1046"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061049890_hu777236092731360809.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061049890_hu11399761947572976844.png 1024w"
	loading="lazy"
	
		alt="image-20240806104911791"
	
	
		class="gallery-image" 
		data-flex-grow="178"
		data-flex-basis="429px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061049735.png"
	width="1839"
	height="1037"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061049735_hu2885634464448488052.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061049735_hu14939616534960107304.png 1024w"
	loading="lazy"
	
		alt="image-20240806104942648"
	
	
		class="gallery-image" 
		data-flex-grow="177"
		data-flex-basis="425px"
	
></p>
<p>数据库设计（address_book表）：</p>
<p>address_book表为地址表，用于存储C端用户的收货地址信息。具体表结构如下：</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>主键</td>
<td>自增</td>
</tr>
<tr>
<td>user_id</td>
<td>bigint</td>
<td>用户id</td>
<td>逻辑外键</td>
</tr>
<tr>
<td>consignee</td>
<td>varchar(50)</td>
<td>收货人</td>
<td></td>
</tr>
<tr>
<td>sex</td>
<td>varchar(2)</td>
<td>性别</td>
<td></td>
</tr>
<tr>
<td>phone</td>
<td>varchar(11)</td>
<td>手机号</td>
<td></td>
</tr>
<tr>
<td>province_code</td>
<td>varchar(12)</td>
<td>省份编码</td>
<td></td>
</tr>
<tr>
<td>province_name</td>
<td>varchar(32)</td>
<td>省份名称</td>
<td></td>
</tr>
<tr>
<td>city_code</td>
<td>varchar(12)</td>
<td>城市编码</td>
<td></td>
</tr>
<tr>
<td>city_name</td>
<td>varchar(32)</td>
<td>城市名称</td>
<td></td>
</tr>
<tr>
<td>district_code</td>
<td>varchar(12)</td>
<td>区县编码</td>
<td></td>
</tr>
<tr>
<td>district_name</td>
<td>varchar(32)</td>
<td>区县名称</td>
<td></td>
</tr>
<tr>
<td>detail</td>
<td>varchar(200)</td>
<td>详细地址信息</td>
<td>具体到门牌号</td>
</tr>
<tr>
<td>label</td>
<td>varchar(100)</td>
<td>标签</td>
<td>公司、家、学校</td>
</tr>
<tr>
<td>is_default</td>
<td>tinyint(1)</td>
<td>是否默认地址</td>
<td>1是 0否</td>
</tr>
</tbody>
</table></div>
<h4 id="代码导入-2">代码导入
</h4><h4 id="功能测试-18">功能测试
</h4><h3 id="用户下单">用户下单
</h3><h4 id="需求分析和设计-16">需求分析和设计
</h4><p>用户下单业务说明：</p>
<p>在电商系统中，用户是通过下单的方式通知商家，用户已经购买了商品，需要商家进行备货和发货。</p>
<p>用户下单后会产生订单相关数据，订单数据需要能够体现如下信息：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061106146.png"
	width="1320"
	height="829"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061106146_hu9525451460616674592.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061106146_hu14182297944555809619.png 1024w"
	loading="lazy"
	
		alt="image-20240806110653045"
	
	
		class="gallery-image" 
		data-flex-grow="159"
		data-flex-basis="382px"
	
></p>
<p>用户点餐业务流程：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061110947.png"
	width="2342"
	height="853"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061110947_hu11114800890658355905.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061110947_hu10320049956230251369.png 1024w"
	loading="lazy"
	
		alt="image-20240806111027821"
	
	
		class="gallery-image" 
		data-flex-grow="274"
		data-flex-basis="658px"
	
></p>
<p>接口设计（分析）：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061115308.png"
	width="1112"
	height="975"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061115308_hu3011953341941232177.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061115308_hu1482568858358380695.png 1024w"
	loading="lazy"
	
		alt="image-20240806111556225"
	
	
		class="gallery-image" 
		data-flex-grow="114"
		data-flex-basis="273px"
	
></p>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061120380.png"
	width="2372"
	height="974"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061120380_hu17466748186801088829.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061120380_hu13676691304618998596.png 1024w"
	loading="lazy"
	
		alt="image-20240806112030256"
	
	
		class="gallery-image" 
		data-flex-grow="243"
		data-flex-basis="584px"
	
></p>
<p>数据库（orders表、order_deatail表）设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061125040.png"
	width="1338"
	height="1029"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061125040_hu16938122021007053570.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061125040_hu5962226073303285530.png 1024w"
	loading="lazy"
	
		alt="image-20240806112510967"
	
	
		class="gallery-image" 
		data-flex-grow="130"
		data-flex-basis="312px"
	
></p>
<p>orders表为订单表，用于存储C端用户的订单数据。具体表结构如下：</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>主键</td>
<td>自增</td>
</tr>
<tr>
<td>number</td>
<td>varchar(50)</td>
<td>订单号</td>
<td></td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>订单状态</td>
<td>1待付款 2待接单 3已接单 4派送中 5已完成 6已取消</td>
</tr>
<tr>
<td>user_id</td>
<td>bigint</td>
<td>用户id</td>
<td>逻辑外键</td>
</tr>
<tr>
<td>address_book_id</td>
<td>bigint</td>
<td>地址id</td>
<td>逻辑外键</td>
</tr>
<tr>
<td>order_time</td>
<td>datetime</td>
<td>下单时间</td>
<td></td>
</tr>
<tr>
<td>checkout_time</td>
<td>datetime</td>
<td>付款时间</td>
<td></td>
</tr>
<tr>
<td>pay_method</td>
<td>int</td>
<td>支付方式</td>
<td>1微信支付 2支付宝支付</td>
</tr>
<tr>
<td>pay_status</td>
<td>tinyint</td>
<td>支付状态</td>
<td>0未支付 1已支付 2退款</td>
</tr>
<tr>
<td>amount</td>
<td>decimal(10,2)</td>
<td>订单金额</td>
<td></td>
</tr>
<tr>
<td>remark</td>
<td>varchar(100)</td>
<td>备注信息</td>
<td></td>
</tr>
<tr>
<td>phone</td>
<td>varchar(11)</td>
<td>手机号</td>
<td></td>
</tr>
<tr>
<td>address</td>
<td>varchar(255)</td>
<td>详细地址信息</td>
<td></td>
</tr>
<tr>
<td>user_name</td>
<td>varchar(32)</td>
<td>用户姓名</td>
<td></td>
</tr>
<tr>
<td>consignee</td>
<td>varchar(32)</td>
<td>收货人</td>
<td></td>
</tr>
<tr>
<td>cancel_reason</td>
<td>varchar(255)</td>
<td>订单取消原因</td>
<td></td>
</tr>
<tr>
<td>rejection_reason</td>
<td>varchar(255)</td>
<td>拒单原因</td>
<td></td>
</tr>
<tr>
<td>cancel_time</td>
<td>datetime</td>
<td>订单取消时间</td>
<td></td>
</tr>
<tr>
<td>estimated_delivery_time</td>
<td>datetime</td>
<td>预计送达时间</td>
<td></td>
</tr>
<tr>
<td>delivery_status</td>
<td>tinyint</td>
<td>配送状态</td>
<td>1立即送出 0选择具体时间</td>
</tr>
<tr>
<td>delivery_time</td>
<td>datetime</td>
<td>送达时间</td>
<td></td>
</tr>
<tr>
<td>pack_amount</td>
<td>int</td>
<td>打包费</td>
<td></td>
</tr>
<tr>
<td>tableware_number</td>
<td>int</td>
<td>餐具数量</td>
<td></td>
</tr>
<tr>
<td>tableware_status</td>
<td>tinyint</td>
<td>餐具数量状态</td>
<td>1按餐量提供 0选择具体数量</td>
</tr>
</tbody>
</table></div>
<p>order_detail表为订单明细表，用于存储C端用户的订单明细数据。具体表结构如下：</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>字段名</th>
<th>数据类型</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>bigint</td>
<td>主键</td>
<td>自增</td>
</tr>
<tr>
<td>name</td>
<td>varchar(32)</td>
<td>商品名称</td>
<td></td>
</tr>
<tr>
<td>image</td>
<td>varchar(255)</td>
<td>商品图片路径</td>
<td></td>
</tr>
<tr>
<td>order_id</td>
<td>bigint</td>
<td>订单id</td>
<td>逻辑外键</td>
</tr>
<tr>
<td>dish_id</td>
<td>bigint</td>
<td>菜品id</td>
<td>逻辑外键</td>
</tr>
<tr>
<td>setmeal_id</td>
<td>bigint</td>
<td>套餐id</td>
<td>逻辑外键</td>
</tr>
<tr>
<td>dish_flavor</td>
<td>varchar(50)</td>
<td>菜品口味</td>
<td></td>
</tr>
<tr>
<td>number</td>
<td>int</td>
<td>商品数量</td>
<td></td>
</tr>
<tr>
<td>amount</td>
<td>decimal(10,2)</td>
<td>商品单价</td>
<td></td>
</tr>
</tbody>
</table></div>
<h4 id="代码开发-16">代码开发
</h4><p>根据用户下单接口的参数设计DTO：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061131851.png"
	width="2366"
	height="956"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061131851_hu2544731845939354125.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061131851_hu18387436582214016359.png 1024w"
	loading="lazy"
	
		alt="image-20240806113153733"
	
	
		class="gallery-image" 
		data-flex-grow="247"
		data-flex-basis="593px"
	
></p>
<p>根据用户下单接口的返回结果设计VO：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061132253.png"
	width="2347"
	height="696"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061132253_hu15697880573107609420.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408061132253_hu14986875517751431113.png 1024w"
	loading="lazy"
	
		alt="image-20240806113257161"
	
	
		class="gallery-image" 
		data-flex-grow="337"
		data-flex-basis="809px"
	
></p>
<h4 id="功能测试-19">功能测试
</h4><h3 id="订单支付">订单支付
</h3><h4 id="微信支付介绍">微信支付介绍
</h4><p>微信支付产品：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071053108.png"
	width="1436"
	height="805"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071053108_hu5875161984674145151.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071053108_hu18159474203959371200.png 1024w"
	loading="lazy"
	
		alt="image-20240807105329028"
	
	
		class="gallery-image" 
		data-flex-grow="178"
		data-flex-basis="428px"
	
></p>
<p>参考：https://pay.weixin.qq.com/static/product/product_index.shtm</p>
<p>微信支付接入流程：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071056810.png"
	width="1810"
	height="561"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071056810_hu2093953439376232793.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071056810_hu6685216696834738010.png 1024w"
	loading="lazy"
	
		alt="image-20240807105618734"
	
	
		class="gallery-image" 
		data-flex-grow="322"
		data-flex-basis="774px"
	
></p>
<p>微信小程序支付时序图：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071058555.png"
	width="1032"
	height="1040"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071058555_hu11573456475392977728.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071058555_hu474191101472381210.png 1024w"
	loading="lazy"
	
		alt="image-20240807105835487"
	
	
		class="gallery-image" 
		data-flex-grow="99"
		data-flex-basis="238px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071101569.png"
	width="683"
	height="536"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071101569_hu16916255156441721759.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071101569_hu4783485506078277081.png 1024w"
	loading="lazy"
	
		alt="image-20240807110117500"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="305px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071105832.png"
	width="837"
	height="540"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071105832_hu16167628657392308791.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071105832_hu8680697027565529545.png 1024w"
	loading="lazy"
	
		alt="image-20240807110516758"
	
	
		class="gallery-image" 
		data-flex-grow="155"
		data-flex-basis="372px"
	
></p>
<p><a class="link" href="https://pay.weixin.qq.com/wiki/doc/apiv3/apis/chapter3_5_1.shtml"  target="_blank" rel="noopener"
    >JSAPI</a>下单：商户系统调用该接口在微信支付服务后台生成<strong>预支付交易单</strong></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071111398.png"
	width="2308"
	height="801"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071111398_hu15681510620692265361.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071111398_hu11217486043768033750.png 1024w"
	loading="lazy"
	
		alt="image-20240807111108288"
	
	
		class="gallery-image" 
		data-flex-grow="288"
		data-flex-basis="691px"
	
></p>
<p><a class="link" href="https://pay.weixin.qq.com/wiki/doc/apiv3/apis/chapter3_5_4.shtml"  target="_blank" rel="noopener"
    >微信小程序调起支付</a>：通过JSAPI下单接口获取到发起支付的必要参数prepay_id，然后使用微信支付提供的小程序方法调起小程序支付</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071116009.png"
	width="2332"
	height="844"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071116009_hu6816882629905482824.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071116009_hu5341759523693669379.png 1024w"
	loading="lazy"
	
		alt="image-20240807111615882"
	
	
		class="gallery-image" 
		data-flex-grow="276"
		data-flex-basis="663px"
	
></p>
<h4 id="微信支付准备工作">微信支付准备工作
</h4><p>微信小程序支付时序图：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071122021.png"
	width="1536"
	height="1046"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071122021_hu3594493490944987480.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071122021_hu1028598777100797886.png 1024w"
	loading="lazy"
	
		alt="image-20240807112213944"
	
	
		class="gallery-image" 
		data-flex-grow="146"
		data-flex-basis="352px"
	
></p>
<p>获取微信支付平台证书、商户私钥文件</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071122994.png"
	width="1009"
	height="114"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071122994_hu2866412644047816006.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071122994_hu6402237291081941756.png 1024w"
	loading="lazy"
	
		alt="image-20240807112249948"
	
	
		class="gallery-image" 
		data-flex-grow="885"
		data-flex-basis="2124px"
	
></p>
<p>获取临时域名：支付成功后微信服务通过该域名回调我们的程序</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071124551.png"
	width="2347"
	height="897"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071124551_hu16900981755939840856.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071124551_hu8148424091690498469.png 1024w"
	loading="lazy"
	
		alt="image-20240807112441385"
	
	
		class="gallery-image" 
		data-flex-grow="261"
		data-flex-basis="627px"
	
></p>
<h4 id="代码导入-3">代码导入
</h4><p>微信支付相关配置：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071135899.png"
	width="2190"
	height="821"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071135899_hu9824702286513528978.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408071135899_hu14697025415357755122.png 1024w"
	loading="lazy"
	
		alt="image-20240807113505769"
	
	
		class="gallery-image" 
		data-flex-grow="266"
		data-flex-basis="640px"
	
></p>
<h4 id="功能测试-20">功能测试
</h4><h2 id="用户端历史订单模块">用户端历史订单模块
</h2><h3 id="1-查询历史订单">1. 查询历史订单
</h3><h4 id="11-需求分析和设计">1.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016944.png"
	width="908"
	height="1058"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016944_hu12531461756069014783.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016944_hu1638289276535301299.png 1024w"
	loading="lazy"
	
		alt="image-20221128092537535"
	
	
		class="gallery-image" 
		data-flex-grow="85"
		data-flex-basis="205px"
	
></p>
<p>业务规则</p>
<ul>
<li>分页查询历史订单</li>
<li>可以根据订单状态查询</li>
<li>展示订单数据时，需要展示的数据包括：下单时间、订单状态、订单金额、订单明细（商品名称、图片）</li>
</ul>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016942.png"
	width="1328"
	height="998"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016942_hu7199429852000561948.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016942_hu7278136711291428587.png 1024w"
	loading="lazy"
	
		alt="image-20221128103222657"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="319px"
	
></p>
<h4 id="12-代码实现">1.2 代码实现
</h4><h5 id="121-userordercontroller">1.2.1 user/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 历史订单查询
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param page
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param pageSize
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param status   订单状态 1待付款 2待接单 3已接单 4派送中 5已完成 6已取消
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&#34;/historyOrders&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;历史订单查询&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="o">&lt;</span><span class="n">PageResult</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">page</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pageSize</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">PageResult</span><span class="w"> </span><span class="n">pageResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderService</span><span class="p">.</span><span class="na">pageQuery4User</span><span class="p">(</span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="n">pageSize</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">(</span><span class="n">pageResult</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="122-orderservice">1.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 用户端订单分页查询
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param page
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param pageSize
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param status
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">PageResult</span><span class="w"> </span><span class="nf">pageQuery4User</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pageSize</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">status</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="123-orderserviceimpl">1.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 用户端订单分页查询
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param pageNum
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param pageSize
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param status
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PageResult</span><span class="w"> </span><span class="nf">pageQuery4User</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">pageNum</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">pageSize</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 设置分页</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">PageHelper</span><span class="p">.</span><span class="na">startPage</span><span class="p">(</span><span class="n">pageNum</span><span class="p">,</span><span class="w"> </span><span class="n">pageSize</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OrdersPageQueryDTO</span><span class="w"> </span><span class="n">ordersPageQueryDTO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrdersPageQueryDTO</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ordersPageQueryDTO</span><span class="p">.</span><span class="na">setUserId</span><span class="p">(</span><span class="n">BaseContext</span><span class="p">.</span><span class="na">getCurrentId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ordersPageQueryDTO</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">status</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 分页条件查询</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Page</span><span class="o">&lt;</span><span class="n">Orders</span><span class="o">&gt;</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">pageQuery</span><span class="p">(</span><span class="n">ordersPageQueryDTO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">OrderVO</span><span class="o">&gt;</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 查询出订单明细，并封装入OrderVO进行响应</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">page</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">page</span><span class="p">.</span><span class="na">getTotal</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">page</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">Long</span><span class="w"> </span><span class="n">orderId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span><span class="p">.</span><span class="na">getId</span><span class="p">();</span><span class="c1">// 订单id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// 查询订单明细</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">List</span><span class="o">&lt;</span><span class="n">OrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderDetails</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderDetailMapper</span><span class="p">.</span><span class="na">getByOrderId</span><span class="p">(</span><span class="n">orderId</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">OrderVO</span><span class="w"> </span><span class="n">orderVO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderVO</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BeanUtils</span><span class="p">.</span><span class="na">copyProperties</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span><span class="w"> </span><span class="n">orderVO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">orderVO</span><span class="p">.</span><span class="na">setOrderDetailList</span><span class="p">(</span><span class="n">orderDetails</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">list</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">orderVO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PageResult</span><span class="p">(</span><span class="n">page</span><span class="p">.</span><span class="na">getTotal</span><span class="p">(),</span><span class="w"> </span><span class="n">list</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="124-ordermapper">1.2.4 OrderMapper
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 分页条件查询并按下单时间排序
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersPageQueryDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Page</span><span class="o">&lt;</span><span class="n">Orders</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">pageQuery</span><span class="p">(</span><span class="n">OrdersPageQueryDTO</span><span class="w"> </span><span class="n">ordersPageQueryDTO</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="125-ordermapperxml">1.2.5 OrderMapper.xml
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;pageQuery&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Orders&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        select * from orders
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;where&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;number != null and number!=&#39;&#39;&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                and number like concat(&#39;%&#39;,#{number},&#39;%&#39;)
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;phone != null and phone!=&#39;&#39;&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                and phone like concat(&#39;%&#39;,#{phone},&#39;%&#39;)
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;userId != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                and user_id = #{userId}
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;status != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                and status = #{status}
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;beginTime != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                and order_time <span class="ni">&amp;gt;</span>= #{beginTime}
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;endTime != null&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">                and order_time <span class="ni">&amp;lt;</span>= #{endTime}
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/where&gt;</span>
</span></span><span class="line"><span class="cl">        order by order_time desc
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="126-orderdetailmapper">1.2.6 OrderDetailMapper
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 根据订单id查询订单明细
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param orderId
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Select</span><span class="p">(</span><span class="s">&#34;select * from order_detail where order_id = #{orderId}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">OrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getByOrderId</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">orderId</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="13-功能测试">1.3 功能测试
</h4><p>略</p>
<h3 id="2-查询订单详情">2. 查询订单详情
</h3><h4 id="21-需求分析和设计">2.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016944.png"
	width="908"
	height="1058"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016944_hu12531461756069014783.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016944_hu1638289276535301299.png 1024w"
	loading="lazy"
	
		alt="image-20221128102144294"
	
	
		class="gallery-image" 
		data-flex-grow="85"
		data-flex-basis="205px"
	
></p>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016945.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016945_hu15884409099165017291.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016945_hu1269897056066150987.png 1024w"
	loading="lazy"
	
		alt="image-20221128142142811"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="22-代码实现">2.2 代码实现
</h4><h5 id="221-userordercontroller">2.2.1 user/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 查询订单详情
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&#34;/orderDetail/{id}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;查询订单详情&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="o">&lt;</span><span class="n">OrderVO</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">details</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">)</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OrderVO</span><span class="w"> </span><span class="n">orderVO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderService</span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">(</span><span class="n">orderVO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="222-orderservice">2.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 查询订单详情
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">OrderVO</span><span class="w"> </span><span class="nf">details</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="223-orderserviceimpl">2.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 查询订单详情
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">OrderVO</span><span class="w"> </span><span class="nf">details</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 根据id查询订单</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">getById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 查询该订单对应的菜品/套餐明细</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">OrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderDetailList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderDetailMapper</span><span class="p">.</span><span class="na">getByOrderId</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 将该订单及其详情封装到OrderVO并返回</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OrderVO</span><span class="w"> </span><span class="n">orderVO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderVO</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">BeanUtils</span><span class="p">.</span><span class="na">copyProperties</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span><span class="w"> </span><span class="n">orderVO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderVO</span><span class="p">.</span><span class="na">setOrderDetailList</span><span class="p">(</span><span class="n">orderDetailList</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">orderVO</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="224-ordermapper">2.2.4 OrderMapper
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 根据id查询订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Select</span><span class="p">(</span><span class="s">&#34;select * from orders where id=#{id}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Orders</span><span class="w"> </span><span class="nf">getById</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="23-功能测试">2.3 功能测试
</h4><p>略</p>
<h3 id="3-取消订单">3. 取消订单
</h3><h4 id="31-需求分析和设计">3.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016952.png"
	width="967"
	height="1007"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016952_hu17175546567931831570.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016952_hu6742382725251828848.png 1024w"
	loading="lazy"
	
		alt="image-20221128145444268"
	
	
		class="gallery-image" 
		data-flex-grow="96"
		data-flex-basis="230px"
	
></p>
<p>业务规则：</p>
<ul>
<li>待支付和待接单状态下，用户可直接取消订单</li>
<li>商家已接单状态下，用户取消订单需电话沟通商家</li>
<li>派送中状态下，用户取消订单需电话沟通商家</li>
<li>如果在待接单状态下取消订单，需要给用户退款</li>
<li>取消订单后需要将订单状态修改为“已取消”</li>
</ul>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016955.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016955_hu4788868277447908764.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016955_hu15525623002948095436.png 1024w"
	loading="lazy"
	
		alt="image-20221128164410852"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="32-代码实现">3.2 代码实现
</h4><h5 id="321-userordercontroller">3.2.1 user/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 用户取消订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PutMapping</span><span class="p">(</span><span class="s">&#34;/cancel/{id}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;取消订单&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">)</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderService</span><span class="p">.</span><span class="na">userCancelById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="322-orderservice">3.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 用户取消订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">userCancelById</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="323-orderserviceimpl">3.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">	</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 用户取消订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">userCancelById</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 根据id查询订单</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">ordersDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">getById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 校验订单是否存在</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ordersDB</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderBusinessException</span><span class="p">(</span><span class="n">MessageConstant</span><span class="p">.</span><span class="na">ORDER_NOT_FOUND</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//订单状态 1待付款 2待接单 3已接单 4派送中 5已完成 6已取消</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getStatus</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderBusinessException</span><span class="p">(</span><span class="n">MessageConstant</span><span class="p">.</span><span class="na">ORDER_STATUS_ERROR</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Orders</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 订单处于待接单状态下取消，需要进行退款</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getStatus</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">TO_BE_CONFIRMED</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//调用微信支付退款接口</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">weChatPayUtil</span><span class="p">.</span><span class="na">refund</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getNumber</span><span class="p">(),</span><span class="w"> </span><span class="c1">//商户订单号</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getNumber</span><span class="p">(),</span><span class="w"> </span><span class="c1">//商户退款单号</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="n">0</span><span class="p">.</span><span class="na">01</span><span class="p">),</span><span class="c1">//退款金额，单位 元</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="n">0</span><span class="p">.</span><span class="na">01</span><span class="p">));</span><span class="c1">//原订单金额</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//支付状态修改为 退款</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">orders</span><span class="p">.</span><span class="na">setPayStatus</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">REFUND</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 更新订单状态、取消原因、取消时间</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">CANCELLED</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setCancelReason</span><span class="p">(</span><span class="s">&#34;用户取消&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setCancelTime</span><span class="p">(</span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="33-功能测试">3.3 功能测试
</h4><p>略</p>
<h3 id="4-再来一单">4. 再来一单
</h3><h4 id="41-需求分析和设计">4.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016562.png"
	width="1146"
	height="1005"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016562_hu4805994837103276937.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016562_hu17997486407092481674.png 1024w"
	loading="lazy"
	
		alt="image-20221128173238656"
	
	
		class="gallery-image" 
		data-flex-grow="114"
		data-flex-basis="273px"
	
></p>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016565.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016565_hu4809752795981565350.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016565_hu14609013317560000649.png 1024w"
	loading="lazy"
	
		alt="image-20221128173350467"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p>业务规则：</p>
<ul>
<li>再来一单就是将原订单中的商品重新加入到购物车中</li>
</ul>
<h4 id="42-代码实现">4.2 代码实现
</h4><h5 id="421-userordercontroller">4.2.1 user/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 再来一单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PostMapping</span><span class="p">(</span><span class="s">&#34;/repetition/{id}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;再来一单&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="nf">repetition</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderService</span><span class="p">.</span><span class="na">repetition</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="422-orderservice">4.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 再来一单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">repetition</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="423-orderserviceimpl">4.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">	</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 再来一单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">repetition</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 查询当前用户id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Long</span><span class="w"> </span><span class="n">userId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BaseContext</span><span class="p">.</span><span class="na">getCurrentId</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 根据订单id查询当前订单详情</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">OrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderDetailList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderDetailMapper</span><span class="p">.</span><span class="na">getByOrderId</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 将订单详情对象转换为购物车对象</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ShoppingCart</span><span class="o">&gt;</span><span class="w"> </span><span class="n">shoppingCartList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderDetailList</span><span class="p">.</span><span class="na">stream</span><span class="p">().</span><span class="na">map</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">ShoppingCart</span><span class="w"> </span><span class="n">shoppingCart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ShoppingCart</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 将原订单详情里面的菜品信息重新复制到购物车对象中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">BeanUtils</span><span class="p">.</span><span class="na">copyProperties</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">shoppingCart</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;id&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">shoppingCart</span><span class="p">.</span><span class="na">setUserId</span><span class="p">(</span><span class="n">userId</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">shoppingCart</span><span class="p">.</span><span class="na">setCreateTime</span><span class="p">(</span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">shoppingCart</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}).</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 将购物车对象批量添加到数据库</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">shoppingCartMapper</span><span class="p">.</span><span class="na">insertBatch</span><span class="p">(</span><span class="n">shoppingCartList</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="424-shoppingcartmapper">4.2.4 ShoppingCartMapper
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 批量插入购物车数据
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param shoppingCartList
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">insertBatch</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">ShoppingCart</span><span class="o">&gt;</span><span class="w"> </span><span class="n">shoppingCartList</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="425-shoppingcartmapperxml">4.2.5 ShoppingCartMapper.xml
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertBatch&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;list&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        insert into shopping_cart
</span></span><span class="line"><span class="cl">        (name, image, user_id, dish_id, setmeal_id, dish_flavor, number, amount, create_time)
</span></span><span class="line"><span class="cl">        values
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;shoppingCartList&#34;</span> <span class="na">item=</span><span class="s">&#34;sc&#34;</span> <span class="na">separator=</span><span class="s">&#34;,&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            (#{sc.name},#{sc.image},#{sc.userId},#{sc.dishId},#{sc.setmealId},#{sc.dishFlavor},#{sc.number},#{sc.amount},#{sc.createTime})
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/foreach&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="43-功能测试">4.3 功能测试
</h4><p>略</p>
<h2 id="商家端订单管理模块">商家端订单管理模块
</h2><h3 id="1-订单搜索">1. 订单搜索
</h3><h4 id="11-需求分析和设计-1">1.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016566.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016566_hu12092397637590234691.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016566_hu10841689664209600581.png 1024w"
	loading="lazy"
	
		alt="image-20221129092023177"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016571.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016571_hu9446247475402017479.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016571_hu522503566552349208.png 1024w"
	loading="lazy"
	
		alt="image-20221129114035570"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016572.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016572_hu7221689985967220949.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016572_hu8735603531105806614.png 1024w"
	loading="lazy"
	
		alt="image-20221129114054664"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016573.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016573_hu11637167132420651474.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016573_hu16801966360106015964.png 1024w"
	loading="lazy"
	
		alt="image-20221129114116492"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016325.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016325_hu18334987806116399556.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016325_hu12501383757825234678.png 1024w"
	loading="lazy"
	
		alt="image-20221129114132956"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016326.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016326_hu5475448696977684684.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016326_hu2890944580205539570.png 1024w"
	loading="lazy"
	
		alt="image-20221129114151055"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p>业务规则：</p>
<ul>
<li>输入订单号/手机号进行搜索，支持模糊搜索</li>
<li>根据订单状态进行筛选</li>
<li>下单时间进行时间筛选</li>
<li>搜索内容为空，提示未找到相关订单</li>
<li>搜索结果页，展示包含搜索关键词的内容</li>
<li>分页展示搜索到的订单数据</li>
</ul>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016327.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016327_hu2372280418733650234.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016327_hu13752058181550145491.png 1024w"
	loading="lazy"
	
		alt="image-20221129092552620"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="12-代码实现-1">1.2 代码实现
</h4><h5 id="121-adminordercontroller">1.2.1 admin/OrderController
</h5><p>在admin包下创建OrderController</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 订单管理
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@RestController</span><span class="p">(</span><span class="s">&#34;adminOrderController&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&#34;/admin/order&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Slf4j</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Api</span><span class="p">(</span><span class="n">tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;订单管理接口&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OrderController</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">OrderService</span><span class="w"> </span><span class="n">orderService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 订单搜索
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersPageQueryDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&#34;/conditionSearch&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;订单搜索&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="o">&lt;</span><span class="n">PageResult</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">conditionSearch</span><span class="p">(</span><span class="n">OrdersPageQueryDTO</span><span class="w"> </span><span class="n">ordersPageQueryDTO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">PageResult</span><span class="w"> </span><span class="n">pageResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderService</span><span class="p">.</span><span class="na">conditionSearch</span><span class="p">(</span><span class="n">ordersPageQueryDTO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">(</span><span class="n">pageResult</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="122-orderservice-1">1.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 条件搜索订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersPageQueryDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">PageResult</span><span class="w"> </span><span class="nf">conditionSearch</span><span class="p">(</span><span class="n">OrdersPageQueryDTO</span><span class="w"> </span><span class="n">ordersPageQueryDTO</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="123-orderserviceimpl-1">1.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 订单搜索
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersPageQueryDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PageResult</span><span class="w"> </span><span class="nf">conditionSearch</span><span class="p">(</span><span class="n">OrdersPageQueryDTO</span><span class="w"> </span><span class="n">ordersPageQueryDTO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">PageHelper</span><span class="p">.</span><span class="na">startPage</span><span class="p">(</span><span class="n">ordersPageQueryDTO</span><span class="p">.</span><span class="na">getPage</span><span class="p">(),</span><span class="w"> </span><span class="n">ordersPageQueryDTO</span><span class="p">.</span><span class="na">getPageSize</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Page</span><span class="o">&lt;</span><span class="n">Orders</span><span class="o">&gt;</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">pageQuery</span><span class="p">(</span><span class="n">ordersPageQueryDTO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 部分订单状态，需要额外返回订单菜品信息，将Orders转化为OrderVO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">OrderVO</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderVOList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getOrderVOList</span><span class="p">(</span><span class="n">page</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PageResult</span><span class="p">(</span><span class="n">page</span><span class="p">.</span><span class="na">getTotal</span><span class="p">(),</span><span class="w"> </span><span class="n">orderVOList</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">OrderVO</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getOrderVOList</span><span class="p">(</span><span class="n">Page</span><span class="o">&lt;</span><span class="n">Orders</span><span class="o">&gt;</span><span class="w"> </span><span class="n">page</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 需要返回订单菜品信息，自定义OrderVO响应结果</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">OrderVO</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderVOList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Orders</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ordersList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">page</span><span class="p">.</span><span class="na">getResult</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">CollectionUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">ordersList</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ordersList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// 将共同字段复制到OrderVO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">OrderVO</span><span class="w"> </span><span class="n">orderVO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderVO</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">BeanUtils</span><span class="p">.</span><span class="na">copyProperties</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span><span class="w"> </span><span class="n">orderVO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">orderDishes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getOrderDishesStr</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// 将订单菜品信息封装到orderVO中，并添加到orderVOList</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">orderVO</span><span class="p">.</span><span class="na">setOrderDishes</span><span class="p">(</span><span class="n">orderDishes</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">orderVOList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">orderVO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">orderVOList</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 根据订单id获取菜品信息字符串
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param orders
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getOrderDishesStr</span><span class="p">(</span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 查询订单菜品详情信息（订单中的菜品和数量）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">OrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderDetailList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderDetailMapper</span><span class="p">.</span><span class="na">getByOrderId</span><span class="p">(</span><span class="n">orders</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 将每一条订单菜品信息拼接为字符串（格式：宫保鸡丁*3；）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderDishList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderDetailList</span><span class="p">.</span><span class="na">stream</span><span class="p">().</span><span class="na">map</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">orderDish</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;*&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="na">getNumber</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;;&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">orderDish</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}).</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 将该订单对应的所有菜品信息拼接在一起</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">join</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">orderDishList</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="13-功能测试-1">1.3 功能测试
</h4><p>略</p>
<h3 id="2-各个状态的订单数量统计">2. 各个状态的订单数量统计
</h3><h4 id="21-需求分析和设计-1">2.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016328.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016328_hu7890318973116337509.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016328_hu13895609874379151661.png 1024w"
	loading="lazy"
	
		alt="image-20221129095804419"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016333.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016333_hu2106868929520913037.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016333_hu3390892593435395726.png 1024w"
	loading="lazy"
	
		alt="image-20221129095912896"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="22-代码实现-1">2.2 代码实现
</h4><h5 id="221-adminordercontroller">2.2.1 admin/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 各个状态的订单数量统计
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&#34;/statistics&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;各个状态的订单数量统计&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="o">&lt;</span><span class="n">OrderStatisticsVO</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">statistics</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OrderStatisticsVO</span><span class="w"> </span><span class="n">orderStatisticsVO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderService</span><span class="p">.</span><span class="na">statistics</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">(</span><span class="n">orderStatisticsVO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="222-orderservice-1">2.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 各个状态的订单数量统计
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">OrderStatisticsVO</span><span class="w"> </span><span class="nf">statistics</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="223-orderserviceimpl-1">2.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 各个状态的订单数量统计
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">OrderStatisticsVO</span><span class="w"> </span><span class="nf">statistics</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 根据状态，分别查询出待接单、待派送、派送中的订单数量</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="w"> </span><span class="n">toBeConfirmed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">countStatus</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">TO_BE_CONFIRMED</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="w"> </span><span class="n">confirmed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">countStatus</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">CONFIRMED</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="w"> </span><span class="n">deliveryInProgress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">countStatus</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">DELIVERY_IN_PROGRESS</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 将查询出的数据封装到orderStatisticsVO中响应</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OrderStatisticsVO</span><span class="w"> </span><span class="n">orderStatisticsVO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderStatisticsVO</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderStatisticsVO</span><span class="p">.</span><span class="na">setToBeConfirmed</span><span class="p">(</span><span class="n">toBeConfirmed</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderStatisticsVO</span><span class="p">.</span><span class="na">setConfirmed</span><span class="p">(</span><span class="n">confirmed</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderStatisticsVO</span><span class="p">.</span><span class="na">setDeliveryInProgress</span><span class="p">(</span><span class="n">deliveryInProgress</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">orderStatisticsVO</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="224-ordermapper-1">2.2.4 OrderMapper
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 根据状态统计订单数量
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param status
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Select</span><span class="p">(</span><span class="s">&#34;select count(id) from orders where status = #{status}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Integer</span><span class="w"> </span><span class="nf">countStatus</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">status</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="23-功能测试-1">2.3 功能测试
</h4><p>略</p>
<h3 id="3-查询订单详情">3. 查询订单详情
</h3><h4 id="31-需求分析和设计-1">3.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016336.png"
	width="606"
	height="738"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016336_hu10090755637968787169.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016336_hu5569767300330002445.png 1024w"
	loading="lazy"
	
		alt="image-20221129101712084"
	
	
		class="gallery-image" 
		data-flex-grow="82"
		data-flex-basis="197px"
	
></p>
<p>业务规则：</p>
<ul>
<li>订单详情页面需要展示订单基本信息（状态、订单号、下单时间、收货人、电话、收货地址、金额等）</li>
<li>订单详情页面需要展示订单明细数据（商品名称、数量、单价）</li>
</ul>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016027.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016027_hu16708206068198529800.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016027_hu6416103381867640510.png 1024w"
	loading="lazy"
	
		alt="image-20221129101035374"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="32-代码实现-1">3.2 代码实现
</h4><h5 id="321-adminordercontroller">3.2.1 admin/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 订单详情
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&#34;/details/{id}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;查询订单详情&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="o">&lt;</span><span class="n">OrderVO</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">details</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">)</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">OrderVO</span><span class="w"> </span><span class="n">orderVO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderService</span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">(</span><span class="n">orderVO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="33-功能测试-1">3.3 功能测试
</h4><p>略</p>
<h3 id="4-接单">4. 接单
</h3><h4 id="41-需求分析和设计-1">4.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016028.png"
	width="593"
	height="788"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016028_hu17365280952310806822.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016028_hu14066785147513611086.png 1024w"
	loading="lazy"
	
		alt="image-20221129105142623"
	
	
		class="gallery-image" 
		data-flex-grow="75"
		data-flex-basis="180px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016028.png"
	width="593"
	height="788"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016028_hu17365280952310806822.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016028_hu14066785147513611086.png 1024w"
	loading="lazy"
	
		alt="image-20221129105116285"
	
	
		class="gallery-image" 
		data-flex-grow="75"
		data-flex-basis="180px"
	
></p>
<p>业务规则：</p>
<ul>
<li>商家接单其实就是将订单的状态修改为“已接单”</li>
</ul>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016033.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016033_hu13943614107269876418.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016033_hu3548894968803923257.png 1024w"
	loading="lazy"
	
		alt="image-20221129105313172"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="42-代码实现-1">4.2 代码实现
</h4><h5 id="421-adminordercontroller">4.2.1 admin/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 接单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PutMapping</span><span class="p">(</span><span class="s">&#34;/confirm&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;接单&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="nf">confirm</span><span class="p">(</span><span class="nd">@RequestBody</span><span class="w"> </span><span class="n">OrdersConfirmDTO</span><span class="w"> </span><span class="n">ordersConfirmDTO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderService</span><span class="p">.</span><span class="na">confirm</span><span class="p">(</span><span class="n">ordersConfirmDTO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="422-orderservice-1">4.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 接单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersConfirmDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">confirm</span><span class="p">(</span><span class="n">OrdersConfirmDTO</span><span class="w"> </span><span class="n">ordersConfirmDTO</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="423-orderserviceimpl-1">4.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 接单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersConfirmDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">confirm</span><span class="p">(</span><span class="n">OrdersConfirmDTO</span><span class="w"> </span><span class="n">ordersConfirmDTO</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Orders</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">id</span><span class="p">(</span><span class="n">ordersConfirmDTO</span><span class="p">.</span><span class="na">getId</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">CONFIRMED</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="43-功能测试-1">4.3 功能测试
</h4><p>略</p>
<h3 id="5-拒单">5. 拒单
</h3><h4 id="51-需求分析和设计">5.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016034.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016034_hu15386614823940303274.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016034_hu18012351094778576606.png 1024w"
	loading="lazy"
	
		alt="image-20221129110358976"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016036.png"
	width="587"
	height="782"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016036_hu14900164599981383801.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016036_hu15636327017904771999.png 1024w"
	loading="lazy"
	
		alt="image-20221129110428390"
	
	
		class="gallery-image" 
		data-flex-grow="75"
		data-flex-basis="180px"
	
></p>
<p>业务规则：</p>
<ul>
<li>商家拒单其实就是将订单状态修改为“已取消”</li>
<li>只有订单处于“待接单”状态时可以执行拒单操作</li>
<li>商家拒单时需要指定拒单原因</li>
<li>商家拒单时，如果用户已经完成了支付，需要为用户退款</li>
</ul>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016663.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016663_hu17111817738959906987.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016663_hu7746532157393082002.png 1024w"
	loading="lazy"
	
		alt="image-20221129110725031"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="52-代码实现">5.2 代码实现
</h4><h5 id="521-adminordercontroller">5.2.1 admin/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 拒单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PutMapping</span><span class="p">(</span><span class="s">&#34;/rejection&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;拒单&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="nf">rejection</span><span class="p">(</span><span class="nd">@RequestBody</span><span class="w"> </span><span class="n">OrdersRejectionDTO</span><span class="w"> </span><span class="n">ordersRejectionDTO</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderService</span><span class="p">.</span><span class="na">rejection</span><span class="p">(</span><span class="n">ordersRejectionDTO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="522-orderservice">5.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 拒单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersRejectionDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">rejection</span><span class="p">(</span><span class="n">OrdersRejectionDTO</span><span class="w"> </span><span class="n">ordersRejectionDTO</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="523-orderserviceimpl">5.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">	</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 拒单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersRejectionDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">rejection</span><span class="p">(</span><span class="n">OrdersRejectionDTO</span><span class="w"> </span><span class="n">ordersRejectionDTO</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 根据id查询订单</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">ordersDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">getById</span><span class="p">(</span><span class="n">ordersRejectionDTO</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 订单只有存在且状态为2（待接单）才可以拒单</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ordersDB</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getStatus</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">TO_BE_CONFIRMED</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderBusinessException</span><span class="p">(</span><span class="n">MessageConstant</span><span class="p">.</span><span class="na">ORDER_STATUS_ERROR</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//支付状态</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="w"> </span><span class="n">payStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getPayStatus</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">payStatus</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Orders</span><span class="p">.</span><span class="na">PAID</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//用户已支付，需要退款</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">refund</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weChatPayUtil</span><span class="p">.</span><span class="na">refund</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getNumber</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getNumber</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="n">0</span><span class="p">.</span><span class="na">01</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="n">0</span><span class="p">.</span><span class="na">01</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;申请退款：{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">refund</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 拒单需要退款，根据订单id更新订单状态、拒单原因、取消时间</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Orders</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">CANCELLED</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setRejectionReason</span><span class="p">(</span><span class="n">ordersRejectionDTO</span><span class="p">.</span><span class="na">getRejectionReason</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setCancelTime</span><span class="p">(</span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="53-功能测试">5.3 功能测试
</h4><p>略</p>
<h3 id="6-取消订单">6. 取消订单
</h3><h4 id="61-需求分析和设计">6.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016664.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016664_hu14684483065466601046.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016664_hu14174784814601777661.png 1024w"
	loading="lazy"
	
		alt="image-20221129111402099"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p>业务规则：</p>
<ul>
<li>取消订单其实就是将订单状态修改为“已取消”</li>
<li>商家取消订单时需要指定取消原因</li>
<li>商家取消订单时，如果用户已经完成了支付，需要为用户退款</li>
</ul>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016665.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016665_hu2812801504892685361.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016665_hu4591353451589687518.png 1024w"
	loading="lazy"
	
		alt="image-20221129112201836"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="62-代码实现">6.2 代码实现
</h4><h5 id="621-adminordercontroller">6.2.1 admin/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 取消订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PutMapping</span><span class="p">(</span><span class="s">&#34;/cancel&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;取消订单&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span><span class="nd">@RequestBody</span><span class="w"> </span><span class="n">OrdersCancelDTO</span><span class="w"> </span><span class="n">ordersCancelDTO</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderService</span><span class="p">.</span><span class="na">cancel</span><span class="p">(</span><span class="n">ordersCancelDTO</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="622-orderservice">6.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 商家取消订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersCancelDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span><span class="n">OrdersCancelDTO</span><span class="w"> </span><span class="n">ordersCancelDTO</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="623-orderserviceimpl">6.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">	</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 取消订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param ordersCancelDTO
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span><span class="n">OrdersCancelDTO</span><span class="w"> </span><span class="n">ordersCancelDTO</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 根据id查询订单</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">ordersDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">getById</span><span class="p">(</span><span class="n">ordersCancelDTO</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//支付状态</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="w"> </span><span class="n">payStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getPayStatus</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">payStatus</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//用户已支付，需要退款</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">refund</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weChatPayUtil</span><span class="p">.</span><span class="na">refund</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getNumber</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getNumber</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="n">0</span><span class="p">.</span><span class="na">01</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="n">0</span><span class="p">.</span><span class="na">01</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;申请退款：{}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">refund</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 管理端取消订单需要退款，根据订单id更新订单状态、取消原因、取消时间</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Orders</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="n">ordersCancelDTO</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">CANCELLED</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setCancelReason</span><span class="p">(</span><span class="n">ordersCancelDTO</span><span class="p">.</span><span class="na">getCancelReason</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setCancelTime</span><span class="p">(</span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="63-功能测试">6.3 功能测试
</h4><p>略</p>
<h3 id="7-派送订单">7. 派送订单
</h3><h4 id="71-需求分析和设计">7.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016668.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016668_hu11127224038247600166.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016668_hu3796769037630185577.png 1024w"
	loading="lazy"
	
		alt="image-20221129113257201"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p>业务规则：</p>
<ul>
<li>派送订单其实就是将订单状态修改为“派送中”</li>
<li>只有状态为“待派送”的订单可以执行派送订单操作</li>
</ul>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016669.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016669_hu1610929411360331487.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016669_hu11650514777093444907.png 1024w"
	loading="lazy"
	
		alt="image-20221129113449124"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="72-代码实现">7.2 代码实现
</h4><h5 id="721-adminordercontroller">7.2.1 admin/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 派送订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PutMapping</span><span class="p">(</span><span class="s">&#34;/delivery/{id}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;派送订单&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="nf">delivery</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">)</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderService</span><span class="p">.</span><span class="na">delivery</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="722-orderservice">7.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 派送订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">delivery</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="723-orderserviceimpl">7.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 派送订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">delivery</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 根据id查询订单</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">ordersDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">getById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 校验订单是否存在，并且状态为3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ordersDB</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getStatus</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">CONFIRMED</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderBusinessException</span><span class="p">(</span><span class="n">MessageConstant</span><span class="p">.</span><span class="na">ORDER_STATUS_ERROR</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Orders</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 更新订单状态,状态转为派送中</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">DELIVERY_IN_PROGRESS</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="73-功能测试">7.3 功能测试
</h4><p>略</p>
<h3 id="8-完成订单">8. 完成订单
</h3><h4 id="81-需求分析和设计">8.1 需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016669.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016669_hu1610929411360331487.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016669_hu11650514777093444907.png 1024w"
	loading="lazy"
	
		alt="image-20221129112554051"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p>业务规则：</p>
<ul>
<li>完成订单其实就是将订单状态修改为“已完成”</li>
<li>只有状态为“派送中”的订单可以执行订单完成操作</li>
</ul>
<p>接口设计：参见接口文档</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016380.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016380_hu10373196034714271353.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016380_hu8350796136096993858.png 1024w"
	loading="lazy"
	
		alt="image-20221129113622784"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<h4 id="82-代码实现">8.2 代码实现
</h4><h5 id="821-adminordercontroller">8.2.1 admin/OrderController
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 完成订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@PutMapping</span><span class="p">(</span><span class="s">&#34;/complete/{id}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ApiOperation</span><span class="p">(</span><span class="s">&#34;完成订单&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Result</span><span class="w"> </span><span class="nf">complete</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="p">(</span><span class="s">&#34;id&#34;</span><span class="p">)</span><span class="w"> </span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderService</span><span class="p">.</span><span class="na">complete</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Result</span><span class="p">.</span><span class="na">success</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="822-orderservice">8.2.2 OrderService
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 完成订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">complete</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h5 id="823-orderserviceimpl">8.2.3 OrderServiceImpl
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 完成订单
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param id
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">complete</span><span class="p">(</span><span class="n">Long</span><span class="w"> </span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 根据id查询订单</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">ordersDB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">getById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 校验订单是否存在，并且状态为4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ordersDB</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getStatus</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">DELIVERY_IN_PROGRESS</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderBusinessException</span><span class="p">(</span><span class="n">MessageConstant</span><span class="p">.</span><span class="na">ORDER_STATUS_ERROR</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Orders</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Orders</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setId</span><span class="p">(</span><span class="n">ordersDB</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 更新订单状态,状态转为完成</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="na">COMPLETED</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orders</span><span class="p">.</span><span class="na">setDeliveryTime</span><span class="p">(</span><span class="n">LocalDateTime</span><span class="p">.</span><span class="na">now</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">orderMapper</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="83-功能测试">8.3 功能测试
</h4><p>略</p>
<h2 id="校验收货地址是否超出配送范围">校验收货地址是否超出配送范围
</h2><h3 id="1-环境准备">1. 环境准备
</h3><p>注册账号：https://passport.baidu.com/v2/?reg&amp;tt=1671699340600&amp;overseas=&amp;gid=CF954C2-A3D2-417F-9FE6-B0F249ED7E33&amp;tpl=pp&amp;u=https%3A%2F%2Flbsyun.baidu.com%2Findex.php%3Ftitle%3D首页</p>
<p>登录百度地图开放平台：https://lbsyun.baidu.com/</p>
<p>进入控制台，创建应用，获取AK：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016383.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016383_hu8744978077519208807.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016383_hu5698355255935562114.png 1024w"
	loading="lazy"
	
		alt="image-20221222170049729"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016390.png"
	width="1920"
	height="914"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016390_hu4172806085877853506.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016390_hu15917490864063206867.png 1024w"
	loading="lazy"
	
		alt="image-20221222170256927"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
></p>
<p>相关接口:</p>
<p><a class="link" href="https://lbsyun.baidu.com/index.php?title=webapi/guide/webservice-geocoding"  target="_blank" rel="noopener"
    >https://lbsyun.baidu.com/index.php?title=webapi/guide/webservice-geocoding</a></p>
<p><a class="link" href="https://lbsyun.baidu.com/index.php?title=webapi/directionlite-v1"  target="_blank" rel="noopener"
    >https://lbsyun.baidu.com/index.php?title=webapi/directionlite-v1</a></p>
<h3 id="2-代码开发">2. 代码开发
</h3><h4 id="21-applicationyml">2.1 application.yml
</h4><p>配置外卖商家店铺地址和百度地图的AK：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016391.png"
	width="1201"
	height="261"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016391_hu16355581875526696516.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072016391_hu17720346110062768597.png 1024w"
	loading="lazy"
	
		alt="image-20221222170819582"
	
	
		class="gallery-image" 
		data-flex-grow="460"
		data-flex-basis="1104px"
	
></p>
<h4 id="22-orderserviceimpl">2.2 OrderServiceImpl
</h4><p>改造OrderServiceImpl，注入上面的配置项：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&#34;${sky.shop.address}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">shopAddress</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&#34;${sky.baidu.ak}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">ak</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在OrderServiceImpl中提供校验方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 检查客户的收货地址是否超出配送范围
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param address
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">checkOutOfRange</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">address</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Map</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;address&#34;</span><span class="p">,</span><span class="n">shopAddress</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;output&#34;</span><span class="p">,</span><span class="s">&#34;json&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;ak&#34;</span><span class="p">,</span><span class="n">ak</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//获取店铺的经纬度坐标</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">shopCoordinate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpClientUtil</span><span class="p">.</span><span class="na">doGet</span><span class="p">(</span><span class="s">&#34;https://api.map.baidu.com/geocoding/v3&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">map</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JSONObject</span><span class="w"> </span><span class="n">jsonObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JSON</span><span class="p">.</span><span class="na">parseObject</span><span class="p">(</span><span class="n">shopCoordinate</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">jsonObject</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&#34;status&#34;</span><span class="p">).</span><span class="na">equals</span><span class="p">(</span><span class="s">&#34;0&#34;</span><span class="p">)){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderBusinessException</span><span class="p">(</span><span class="s">&#34;店铺地址解析失败&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//数据解析</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JSONObject</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonObject</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&#34;result&#34;</span><span class="p">).</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&#34;location&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&#34;lat&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">lng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&#34;lng&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//店铺经纬度坐标</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">shopLngLat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;,&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lng</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;address&#34;</span><span class="p">,</span><span class="n">address</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//获取用户收货地址的经纬度坐标</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">userCoordinate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpClientUtil</span><span class="p">.</span><span class="na">doGet</span><span class="p">(</span><span class="s">&#34;https://api.map.baidu.com/geocoding/v3&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">map</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">jsonObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JSON</span><span class="p">.</span><span class="na">parseObject</span><span class="p">(</span><span class="n">userCoordinate</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">jsonObject</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&#34;status&#34;</span><span class="p">).</span><span class="na">equals</span><span class="p">(</span><span class="s">&#34;0&#34;</span><span class="p">)){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderBusinessException</span><span class="p">(</span><span class="s">&#34;收货地址解析失败&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//数据解析</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonObject</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&#34;result&#34;</span><span class="p">).</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&#34;location&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">lat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&#34;lat&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">lng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">location</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&#34;lng&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//用户收货地址经纬度坐标</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">userLngLat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lat</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;,&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lng</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;origin&#34;</span><span class="p">,</span><span class="n">shopLngLat</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;destination&#34;</span><span class="p">,</span><span class="n">userLngLat</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;steps_info&#34;</span><span class="p">,</span><span class="s">&#34;0&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//路线规划</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">json</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HttpClientUtil</span><span class="p">.</span><span class="na">doGet</span><span class="p">(</span><span class="s">&#34;https://api.map.baidu.com/directionlite/v1/driving&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">map</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">jsonObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JSON</span><span class="p">.</span><span class="na">parseObject</span><span class="p">(</span><span class="n">json</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">jsonObject</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&#34;status&#34;</span><span class="p">).</span><span class="na">equals</span><span class="p">(</span><span class="s">&#34;0&#34;</span><span class="p">)){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderBusinessException</span><span class="p">(</span><span class="s">&#34;配送路线规划失败&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//数据解析</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JSONObject</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jsonObject</span><span class="p">.</span><span class="na">getJSONObject</span><span class="p">(</span><span class="s">&#34;result&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">JSONArray</span><span class="w"> </span><span class="n">jsonArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">JSONArray</span><span class="p">)</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&#34;routes&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Integer</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Integer</span><span class="p">)</span><span class="w"> </span><span class="p">((</span><span class="n">JSONObject</span><span class="p">)</span><span class="w"> </span><span class="n">jsonArray</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">0</span><span class="p">)).</span><span class="na">get</span><span class="p">(</span><span class="s">&#34;distance&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">distance</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">5000</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//配送距离超过5000米</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderBusinessException</span><span class="p">(</span><span class="s">&#34;超出配送范围&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>在OrderServiceImpl的submitOrder方法中调用上面的校验方法：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072020424.png"
	width="1393"
	height="727"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072020424_hu14077799901089998303.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408072020424_hu9321275798380057284.png 1024w"
	loading="lazy"
	
		alt="image-20240807202040336"
	
	
		class="gallery-image" 
		data-flex-grow="191"
		data-flex-basis="459px"
	
></p>
<h2 id="订单状态定时处理来单提醒和客户催单">订单状态定时处理、来单提醒和客户催单
</h2><h3 id="spring-task">Spring Task
</h3><p>Spring Task 是Spring框架提供的<strong>任务调度工具</strong>，可以按照约定的时间<strong>自动执行</strong>某个代码逻辑。</p>
<p>定位：定时任务框架</p>
<p>作用：定时自动执行某段Java代码</p>
<h4 id="介绍-3">介绍
</h4><p>应用场景：</p>
<ul>
<li>信用卡每月还卡提醒</li>
<li>银行贷款每月还款提醒</li>
<li>火车票售票系统处理未支付订单</li>
<li>入职纪念日为用户发送通知</li>
</ul>
<h4 id="cron表达式">cron表达式
</h4><p>cron表达式其实就是一个字符串，通过cron表达式可以<strong>定义任务触发的时间</strong></p>
<p>构成规则：分为6或7个域，由空格分隔开，每个域代表一个含义</p>
<p>每个域的含义分别为：秒、分钟、小时、日、月、周、年(可选) 周 和 日互斥，只能选择其一，另外一个选择？</p>
<p>2022年10月12日上午9点整 对应的cron表达式： 0 0 9 12 10 ？2022</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408081054361.png"
	width="1415"
	height="200"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408081054361_hu16084127082746116923.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408081054361_hu8318508019142188691.png 1024w"
	loading="lazy"
	
		alt="image-20240808105440295"
	
	
		class="gallery-image" 
		data-flex-grow="707"
		data-flex-basis="1698px"
	
></p>
<h4 id="入门案例-2">入门案例
</h4><p>Spring Task使用步骤：</p>
<ol>
<li>导入Maven坐标 spring-context</li>
<li>启动类添加注解<code>@EnableScheduling</code>开启任务调度</li>
<li>自定义定时任务类</li>
</ol>
<h3 id="订单状态定时处理">订单状态定时处理
</h3><h4 id="需求分析和设计-17">需求分析和设计
</h4><p>用户下单后可能存在的情况：</p>
<ul>
<li>下单未支付，订单一直处于“<strong>未支付</strong>”状态</li>
<li>用户收货后管理端未点击完成按钮，订单一直处于“<strong>派送中</strong>”状态</li>
</ul>
<p>对于上面两种情况需要通过<strong>定时任务</strong>来修改订单状态，具体逻辑为：</p>
<ul>
<li>通过定时任务<strong>每分钟检查一次</strong>是否存在支付超时订单（下单后超过15分钟仍未支付则判定为支付超时订单），如果存在则修改订单状态为“已取消”</li>
<li>通过定时任务<strong>每天凌晨1点检查一次</strong>是否存在“派送中”的订单，如果存在则修改订单状态为“已完成”</li>
</ul>
<h4 id="代码开发-17">代码开发
</h4><h4 id="功能测试-21">功能测试
</h4><h3 id="websocket">WebSocket
</h3><h4 id="介绍-4">介绍
</h4><p>WebSocket 是基于 TCP 的一种新的<strong>网络协议</strong>。它实现了浏览器与服务器全双工通信——浏览器和服务器只需要完成一次握手，两者之间就可以创建<strong>持久性</strong>的连接，并进行<strong>双向</strong>数据传输。</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082141071.png"
	width="502"
	height="804"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082141071_hu15680051728295251114.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082141071_hu9835670564279038536.png 1024w"
	loading="lazy"
	
		alt="image-20240808214104004"
	
	
		class="gallery-image" 
		data-flex-grow="62"
		data-flex-basis="149px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082141784.png"
	width="477"
	height="804"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082141784_hu14768815317006297486.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082141784_hu811242610482719759.png 1024w"
	loading="lazy"
	
		alt="image-20240808214121713"
	
	
		class="gallery-image" 
		data-flex-grow="59"
		data-flex-basis="142px"
	
></p>
<p>HTTP协议和WebSocket协议对比：</p>
<ul>
<li>HTTP是<strong>短连接</strong></li>
<li>WebSocket是<strong>长连接</strong></li>
<li>HTTP通信是<strong>单向</strong>的，基于请求响应模式</li>
<li>WebSocket支持<strong>双向通信</strong></li>
<li>HTTP和WebSocket底层都是TCP连接</li>
</ul>
<p>应用场景</p>
<ul>
<li>视频弹幕</li>
<li>网页聊天</li>
<li>体育实况更新</li>
<li>股票基金报价实时更新</li>
</ul>
<p>效果展示：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082201411.png"
	width="2003"
	height="961"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082201411_hu8862084432472658110.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082201411_hu6802253392560294263.png 1024w"
	loading="lazy"
	
		alt="image-20240808220107304"
	
	
		class="gallery-image" 
		data-flex-grow="208"
		data-flex-basis="500px"
	
></p>
<h4 id="入门案例-3">入门案例
</h4><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082202859.png"
	width="737"
	height="274"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082202859_hu8952575065269261714.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082202859_hu7260209358144748170.png 1024w"
	loading="lazy"
	
		alt="image-20240808220251814"
	
	
		class="gallery-image" 
		data-flex-grow="268"
		data-flex-basis="645px"
	
></p>
<p>实现步骤：</p>
<ol>
<li>直接使用websocket.html页面作为WebSocket客户端</li>
<li>导入WebSocket的maven坐标</li>
<li>导入WebSocket服务端组建WebSocketServer，用于和客户端通信</li>
<li>导入配置类WebSocketConfiguration，注册WebSocket的服务端组件</li>
<li>导入定时任务类WebSocketTask，定时向客户端推送数据</li>
</ol>
<h3 id="来单提醒">来单提醒
</h3><h4 id="需求分析和设计-18">需求分析和设计
</h4><p>用户下单并且支付成功后需要第一时间通知外卖商家。通知的形式有如下两种：</p>
<ul>
<li>语音播报</li>
<li>弹出提示框</li>
</ul>
<p>设计：</p>
<ul>
<li>通过WebSocket实现管理端页面和服务端页面保持长连接状态</li>
<li>当客户支付后，调用WebSocket的相关API实现服务端向管理端推送消息</li>
<li>管理端浏览器解析服务端推送的消息，判断是来单提醒还是客户催单，进行相应的消息提示和语音播报</li>
<li>约定服务端发送给客户端浏览器的数据格式为JSON，字段包括：type、orderid、content
<ul>
<li>type 为消息类型，1为来单提醒，2为客户催单</li>
<li>orderid 为订单id</li>
<li>content 为消息内容</li>
</ul>
</li>
</ul>
<h4 id="代码开发-18">代码开发
</h4><h4 id="功能测试-22">功能测试
</h4><h3 id="客户催单">客户催单
</h3><h4 id="需求分析和设计-19">需求分析和设计
</h4><p>用户在小程序中点击催单按钮后，需要第一时间通知外卖商家。通知的形式有如下两种：</p>
<ul>
<li>语音播报</li>
<li>弹出提示框</li>
</ul>
<p>设计：</p>
<ul>
<li>通过WebSocket实现管理端页面和服务端页面保持长连接状态</li>
<li>当用户点击催单按钮后，调用WebSocket的相关API实现服务端向管理端推送消息</li>
<li>管理端浏览器解析服务端推送的消息，判断是来单提醒还是客户催单，进行相应的消息提示和语音播报</li>
<li>约定服务端发送给客户端浏览器的数据格式为JSON，字段包括：type、orderid、content
<ul>
<li>type 为消息类型，1为来单提醒，2为客户催单</li>
<li>orderid 为订单id</li>
<li>content 为消息内容</li>
</ul>
</li>
</ul>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082318765.png"
	width="767"
	height="1010"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082318765_hu337189406923410967.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408082318765_hu17621262587571979331.png 1024w"
	loading="lazy"
	
		alt="image-20240808231835680"
	
	
		class="gallery-image" 
		data-flex-grow="75"
		data-flex-basis="182px"
	
></p>
<h4 id="代码开发-19">代码开发
</h4><h4 id="功能测试-23">功能测试
</h4><h2 id="数据统计-图形报表">数据统计-图形报表
</h2><p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091025781.png"
	width="2224"
	height="1080"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091025781_hu15953061508128889544.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091025781_hu3200737885572126835.png 1024w"
	loading="lazy"
	
		alt="image-20240809102537649"
	
	
		class="gallery-image" 
		data-flex-grow="205"
		data-flex-basis="494px"
	
></p>
<h3 id="apache-echarts">Apache Echarts
</h3><h4 id="介绍-5">介绍
</h4><p>Apache Echarts是一款基于Javascript 的数据可视化图表库，提供直观，生动，可交互，可个性化定制的数据可视化图表。</p>
<p>官网地址：https://echarts.apache.org/zh/index.html</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030183.png"
	width="1920"
	height="911"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030183_hu4960929668353931866.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030183_hu10725363706517021338.png 1024w"
	loading="lazy"
	
		alt="image-20240809103022101"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="505px"
	
></p>
<p>效果展示：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030680.png"
	width="1541"
	height="793"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030680_hu10108251605854636239.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030680_hu18439282450563554386.png 1024w"
	loading="lazy"
	
		alt="image-20240809103034606"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="466px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030056.png"
	width="1563"
	height="797"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030056_hu7415605086433069834.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030056_hu274026590083801980.png 1024w"
	loading="lazy"
	
		alt="image-20240809103045974"
	
	
		class="gallery-image" 
		data-flex-grow="196"
		data-flex-basis="470px"
	
></p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030925.png"
	width="1521"
	height="780"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030925_hu16509168946394266655.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091030925_hu17168110138350577148.png 1024w"
	loading="lazy"
	
		alt="image-20240809103052856"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="468px"
	
></p>
<h4 id="入门案例-4">入门案例
</h4><p>总结:使用Echarts，重点在于研究当前图表所需的<strong>数据格式</strong>。通常是需要后端提供符合格式要求的动态数据，然后响应给前端来展示图表。</p>
<h3 id="营业额统计">营业额统计
</h3><h4 id="需求分析和设计-20">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091047037.png"
	width="1194"
	height="687"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091047037_hu313539220132365461.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091047037_hu15198736408265244505.png 1024w"
	loading="lazy"
	
		alt="image-20240809104723921"
	
	
		class="gallery-image" 
		data-flex-grow="173"
		data-flex-basis="417px"
	
></p>
<p>业务规则：</p>
<ul>
<li>营业额指订单状态为已完成的订单金额合计</li>
<li>基于可视化报表的折线图展示营业额数据，X轴为日期，Y轴为营业额</li>
<li>根据时间选择区间，展示每天的营业额数据</li>
</ul>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091126490.png"
	width="2152"
	height="843"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091126490_hu9939682648157869880.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091126490_hu1007894644636021762.png 1024w"
	loading="lazy"
	
		alt="image-20240809112638378"
	
	
		class="gallery-image" 
		data-flex-grow="255"
		data-flex-basis="612px"
	
></p>
<h4 id="代码开发-20">代码开发
</h4><p>根据接口定义设计对应的VO：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091129262.png"
	width="2259"
	height="524"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091129262_hu2354540996214480225.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091129262_hu16263861830408719873.png 1024w"
	loading="lazy"
	
		alt="image-20240809112924190"
	
	
		class="gallery-image" 
		data-flex-grow="431"
		data-flex-basis="1034px"
	
></p>
<h4 id="功能测试-24">功能测试
</h4><h3 id="用户统计">用户统计
</h3><h4 id="需求分析和设计-21">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091504564.png"
	width="1348"
	height="706"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091504564_hu12761922330329925259.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091504564_hu11722925170378166355.png 1024w"
	loading="lazy"
	
		alt="image-20240809150429471"
	
	
		class="gallery-image" 
		data-flex-grow="190"
		data-flex-basis="458px"
	
></p>
<p>业务规则：</p>
<ul>
<li>基于可视化报表的折线图展示用户数据，x轴为日期，y轴为用户数</li>
<li>根据时间选择区间，展示每天的用户总量和新增用户量数据</li>
</ul>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091509119.png"
	width="2053"
	height="749"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091509119_hu2817359578657644539.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091509119_hu3203427461620074159.png 1024w"
	loading="lazy"
	
		alt="image-20240809150912031"
	
	
		class="gallery-image" 
		data-flex-grow="274"
		data-flex-basis="657px"
	
></p>
<h4 id="代码开发-21">代码开发
</h4><p>根据用户统计接口的返回结果设计VO：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091511209.png"
	width="2204"
	height="670"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091511209_hu15053690441409988535.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091511209_hu2341662214150559910.png 1024w"
	loading="lazy"
	
		alt="image-20240809151111119"
	
	
		class="gallery-image" 
		data-flex-grow="328"
		data-flex-basis="789px"
	
></p>
<h4 id="功能测试-25">功能测试
</h4><h3 id="订单统计">订单统计
</h3><h4 id="需求分析和设计-22">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091554653.png"
	width="1130"
	height="656"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091554653_hu1960753499186641413.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091554653_hu8580591640641972588.png 1024w"
	loading="lazy"
	
		alt="image-20240809155455580"
	
	
		class="gallery-image" 
		data-flex-grow="172"
		data-flex-basis="413px"
	
></p>
<p>业务规则：</p>
<ul>
<li>有效订单指状态为“已完成”的订单</li>
<li>基于可视化报表的折线图展示订单数据，X轴为日期，Y轴为订单数量</li>
<li>根据时间选择区间，展示每天的订单总数和有效订单数</li>
<li>展示所选时间区间内的有效订单数、总订单数、订单完成率，订单完成率=有效订单数/总订单数 * 100%</li>
</ul>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091606309.png"
	width="2188"
	height="895"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091606309_hu3289485395716160662.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091606309_hu11883399365145396533.png 1024w"
	loading="lazy"
	
		alt="image-20240809160632211"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="586px"
	
></p>
<h4 id="代码开发-22">代码开发
</h4><p>根据订单统计接口的返回结果设计VO：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091608606.png"
	width="2193"
	height="889"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091608606_hu2233797264018855656.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091608606_hu13471078808231627617.png 1024w"
	loading="lazy"
	
		alt="image-20240809160816506"
	
	
		class="gallery-image" 
		data-flex-grow="246"
		data-flex-basis="592px"
	
></p>
<h4 id="功能测试-26">功能测试
</h4><h3 id="销量排行top10">销量排行Top10
</h3><h4 id="需求分析和设计-23">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091957406.png"
	width="1008"
	height="627"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091957406_hu829879058976275462.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408091957406_hu15968209516026292917.png 1024w"
	loading="lazy"
	
		alt="image-20240809195731336"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="385px"
	
></p>
<p>业务规则：</p>
<ul>
<li>根据时间选择区间，展示销量前10的商品（包括菜品和套餐）</li>
<li>基于可视化报表的柱状图降序展示商品销量</li>
<li>此处的销量为商品销售的份数</li>
</ul>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408092002097.png"
	width="2051"
	height="773"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408092002097_hu18129035517507871479.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408092002097_hu1379916656720041454.png 1024w"
	loading="lazy"
	
		alt="image-20240809200216011"
	
	
		class="gallery-image" 
		data-flex-grow="265"
		data-flex-basis="636px"
	
></p>
<h4 id="代码开发-23">代码开发
</h4><p>根据销量排名接口的返回结果设计VO：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408092003305.png"
	width="2313"
	height="600"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408092003305_hu9733027541821735300.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408092003305_hu13703059747737668486.png 1024w"
	loading="lazy"
	
		alt="image-20240809200340210"
	
	
		class="gallery-image" 
		data-flex-grow="385"
		data-flex-basis="925px"
	
></p>
<h4 id="功能测试-27">功能测试
</h4><h2 id="数据统计-excel报表">数据统计-Excel报表
</h2><h3 id="工作台">工作台
</h3><h4 id="需求分析和设计-24">需求分析和设计
</h4><p>工作台是系统运营的数据看板，并提供快捷操作入口，可以有效提高商家的工作效率。</p>
<p>工作台展示的数据：</p>
<ul>
<li>今日数据</li>
<li>订单管理</li>
<li>菜品总览</li>
<li>套餐总览</li>
<li>订单信息</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100928296.png"
	width="1529"
	height="907"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100928296_hu14315532987651896072.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100928296_hu5688095833288213638.png 1024w"
	loading="lazy"
	
		alt="image-20240810092849178"
	
	
		class="gallery-image" 
		data-flex-grow="168"
		data-flex-basis="404px"
	
></p>
<p>名词解释：</p>
<ul>
<li>营业额：已完成订单的总金额</li>
<li>有效订单：已完成订单的数量</li>
<li>订单完成率：有效订单数、总订单数 * 100</li>
<li>平均客单价：营业额 / 有效订单数</li>
<li>新增用户：新增用户的数量</li>
</ul>
<p>接口设计：</p>
<ul>
<li>今日数据接口</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100940978.png"
	width="1862"
	height="796"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100940978_hu1682144375432988794.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100940978_hu4568462135808145180.png 1024w"
	loading="lazy"
	
		alt="image-20240810094048891"
	
	
		class="gallery-image" 
		data-flex-grow="233"
		data-flex-basis="561px"
	
></p>
<ul>
<li>订单管理接口</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100941204.png"
	width="1063"
	height="1182"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100941204_hu12694349138332411672.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100941204_hu10846164411761930719.png 1024w"
	loading="lazy"
	
		alt="image-20240810094135128"
	
	
		class="gallery-image" 
		data-flex-grow="89"
		data-flex-basis="215px"
	
></p>
<ul>
<li>菜品总览接口</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100942330.png"
	width="1143"
	height="1027"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100942330_hu279925190630493587.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100942330_hu997643553049955916.png 1024w"
	loading="lazy"
	
		alt="image-20240810094210253"
	
	
		class="gallery-image" 
		data-flex-grow="111"
		data-flex-basis="267px"
	
></p>
<ul>
<li>套餐总览接口</li>
</ul>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100942575.png"
	width="1121"
	height="1015"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100942575_hu4527557117000803595.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408100942575_hu16853837345740545308.png 1024w"
	loading="lazy"
	
		alt="image-20240810094229500"
	
	
		class="gallery-image" 
		data-flex-grow="110"
		data-flex-basis="265px"
	
></p>
<ul>
<li>订单搜索（已完成）</li>
<li>各个状态的订单数量统计（已完成）</li>
</ul>
<h4 id="代码导入-4">代码导入
</h4><h4 id="功能测试-28">功能测试
</h4><h3 id="apache-poi">Apache POI
</h3><h4 id="介绍-6">介绍
</h4><p>Apache POl是一个处理Miscrosoft Office各种文件格式的开源项目。简单来说就是，我们可以使用 POl 在 Java 程序中对Miscrosoft Office各种文件进行读写操作。</p>
<p>一般情况下，POI都是用于操作Excel文件。</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101051252.png"
	width="1011"
	height="248"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101051252_hu333417224933802675.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101051252_hu16145857332346066570.png 1024w"
	loading="lazy"
	
		alt="image-20240810105131175"
	
	
		class="gallery-image" 
		data-flex-grow="407"
		data-flex-basis="978px"
	
></p>
<p>Apache POI 的应用场景：</p>
<ul>
<li>银行网银系统导出交易明细</li>
<li>各种业务系统导出Excel报表</li>
<li>批量导入业务数据</li>
</ul>
<h4 id="入门案例-5">入门案例
</h4><p>Apache POI的maven坐标：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101058965.png"
	width="767"
	height="421"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101058965_hu15838258376190064391.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101058965_hu10639343045577009997.png 1024w"
	loading="lazy"
	
		alt="image-20240810105839892"
	
	
		class="gallery-image" 
		data-flex-grow="182"
		data-flex-basis="437px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">POITest</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 通过POI创建Excel文件并且写入文件内容
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">write</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//在内存中创建一个Excel文件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">XSSFWorkbook</span><span class="w"> </span><span class="n">excel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">XSSFWorkbook</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//在Excel文件中创建一个sheet页</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">XSSFSheet</span><span class="w"> </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">excel</span><span class="p">.</span><span class="na">createSheet</span><span class="p">(</span><span class="s">&#34;info&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//在sheet页中创建行对象，rownum编号从0开始</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">XSSFRow</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sheet</span><span class="p">.</span><span class="na">createRow</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//创建单元格，并且写入文件内容</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="n">1</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span><span class="s">&#34;姓名&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="n">2</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span><span class="s">&#34;城市&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//创建一个新行</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sheet</span><span class="p">.</span><span class="na">createRow</span><span class="p">(</span><span class="n">2</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="n">1</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span><span class="s">&#34;张三&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="n">2</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span><span class="s">&#34;北京&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sheet</span><span class="p">.</span><span class="na">createRow</span><span class="p">(</span><span class="n">3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="n">1</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span><span class="s">&#34;李四&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="n">2</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span><span class="s">&#34;南京&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//通过输出流将内存中的Excel文件写入磁盘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">FileOutputStream</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileOutputStream</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s">&#34;D:\\Projects\\info.xlsx&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">excel</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">out</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//关闭资源</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">out</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">excel</span><span class="p">.</span><span class="na">close</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">write</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="导出运营数据excel报表">导出运营数据Excel报表
</h3><h4 id="需求分析和设计-25">需求分析和设计
</h4><p>产品原型：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101139786.png"
	width="1753"
	height="1026"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101139786_hu10813712175322508064.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101139786_hu6723398048032283334.png 1024w"
	loading="lazy"
	
		alt="image-20240810113900669"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="410px"
	
></p>
<p>导出的Excel报表格式：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101139516.png"
	width="1088"
	height="737"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101139516_hu8405943098185407305.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408101139516_hu6363671563550893012.png 1024w"
	loading="lazy"
	
		alt="image-20240810113957432"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="354px"
	
></p>
<p>业务规则：</p>
<ul>
<li>导出Excel形式的报表文件</li>
<li>导出最近30天的运营数据</li>
</ul>
<p>接口设计：</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408110933667.png"
	width="439"
	height="583"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408110933667_hu9639421387338964516.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408110933667_hu8318414944942953431.png 1024w"
	loading="lazy"
	
		alt="image-20240811093337607"
	
	
		class="gallery-image" 
		data-flex-grow="75"
		data-flex-basis="180px"
	
></p>
<p>注意：当前接口没有返回数据，因为报表导出功能本质上是文件下载，服务端会通过输出流将Excel文件下载到客户端浏览器</p>
<h4 id="代码开发-24">代码开发
</h4><p>实现步骤：</p>
<ol>
<li>
<p>设计Excel模板文件</p>
<p><img src="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408110938472.png"
	width="995"
	height="678"
	srcset="/p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408110938472_hu7241351871765082136.png 480w, /p/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/202408110938472_hu13076388005238285332.png 1024w"
	loading="lazy"
	
		alt="image-20240811093833403"
	
	
		class="gallery-image" 
		data-flex-grow="146"
		data-flex-basis="352px"
	
></p>
</li>
<li>
<p>查询近30天的运营数据</p>
</li>
<li>
<p>将查询到的运营数据写入模板文件</p>
</li>
<li>
<p>通过输出流将Excel文件下载到客户端浏览器</p>
</li>
</ol>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/java%E5%90%8E%E7%AB%AF/">Java后端</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.body, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/">
        
        
            <div class="article-image">
                <img src="/p/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/image.12aa1ca5a4449db28b2d977929777383_hu606158492152099387.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 数据库索引完全指南"
                        
                        data-hash="md5-EqocpaREnbKLLZd5KXdzgw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">数据库索引完全指南</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/java%E9%9D%A2%E8%AF%95/">
        
        
            <div class="article-image">
                <img src="/p/java%E9%9D%A2%E8%AF%95/image.12aa1ca5a4449db28b2d977929777383_hu606158492152099387.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Java面试"
                        
                        data-hash="md5-EqocpaREnbKLLZd5KXdzgw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Java面试</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%92%8Caop/">
        
        
            <div class="article-image">
                <img src="/p/%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%92%8Caop/image.12aa1ca5a4449db28b2d977929777383_hu606158492152099387.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 事务管理和AOP"
                        
                        data-hash="md5-EqocpaREnbKLLZd5KXdzgw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">事务管理和AOP</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94%E5%88%86%E5%B1%82%E8%A7%A3%E8%80%A6/">
        
        
            <div class="article-image">
                <img src="/p/%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94%E5%88%86%E5%B1%82%E8%A7%A3%E8%80%A6/image.12aa1ca5a4449db28b2d977929777383_hu606158492152099387.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 请求响应,分层解耦"
                        
                        data-hash="md5-EqocpaREnbKLLZd5KXdzgw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">请求响应,分层解耦</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/mysql-dql/">
        
        
            <div class="article-image">
                <img src="/p/mysql-dql/image.12aa1ca5a4449db28b2d977929777383_hu606158492152099387.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Mysql DQL"
                        
                        data-hash="md5-EqocpaREnbKLLZd5KXdzgw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Mysql DQL</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="nova-bryan/nova-bryan.github.io"
    data-repo-id="R_kgDOOTfQCg"
    data-category="Announcements"
    data-category-id="DIC_kwDOOTfQCs4CowIa"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="top"
    data-theme="light"
    data-lang="zh-CN"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2023 - 
        
        2025 Example Person
    </section>
    
    <section class="powerby">
        
            NovaBryan的博客 <br/>
        使用 <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> 构建 <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
